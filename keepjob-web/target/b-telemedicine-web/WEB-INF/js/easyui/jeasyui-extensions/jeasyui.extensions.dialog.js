(function(j,g){j.fn.dialog.extensions={};var k=j.util.$.easyui?j.util.$.easyui:j.easyui,c=k.frameMapCache?k.frameMapCache:k.frameMapCache=[];function e(p){var q=j.array.filter(c,function(r){return r.current==p}),o=q.length;while(o--){j.array.remove(c,q[o])}}var i=function(){var q=j.util.currentFrame;if(!q){return j.util.top}var o=j.array.first(c,function(p){return p.current==q});return(o&&o.parent&&o.parent.contentWindow)?o.parent.contentWindow:j.util.parent};j.easyui.parent=i();j.easyui.parent.closeDialog=j.easyui.closeCurrentDialog=function(){if(j.util.isUtilTop){return}j.easyui.parent.$(j.util.currentFrame).closest("div.window-body").dialog("close")};j.easyui._showDialog=function(o,p){if(o.onApply==null||o.onApply==g){o.onApply=o.onSave}if(o.onSave==null||o.onSave==g){o.onSave=o.onApply}var t=o.onClose;o.onClose=function(){if(j.isFunction(t)){t.apply(this,arguments)}j.fn.dialog.defaults.onClose.apply(this,arguments);if(o.autoDestroy){j(this).dialog("destroy")}};var y=o.onBeforeDestroy;o.onBeforeDestroy=function(){if(o.iniframe){var B=j(this).dialog("iframe");e(B[0])}var A;if(j.isFunction(y)){A=y.apply(this,arguments)}if(j.fn.dialog.defaults.onBeforeDestroy.apply(this,arguments)==false){return false}return A};if(o.locale){o.inline=true}var u=j("<div></div>").appendTo(o.locale?o.locale:"body");if(!j.util.likeArray(o.toolbar)){o.toolbar=[]}if(j.isArray(o.toolbar)){j.each(o.toolbar,function(){var A=this.handler;if(j.isFunction(A)){this.handler=function(){A.call(u,u)}}});if(!o.toolbar.length){o.toolbar=null}}var w=[btnSave={id:"save",text:o.saveButtonText,iconCls:o.saveButtonIconCls,index:o.saveButtonIndex,hidden:o.enableSaveButton?false:true,handler:function(B){var A=j.isFunction(o.onSave);if(!A||A&&o.onSave.call(this,B)!==false){j.util.exec(function(){B.dialog("close")})}}},btnClose={id:"close",text:o.closeButtonText,iconCls:o.closeButtonIconCls,index:o.closeButtonIndex,hidden:o.enableCloseButton?false:true,handler:function(A){A.dialog("close")}},btnApply={id:"apply",text:o.applyButtonText,iconCls:o.applyButtonIconCls,index:o.applyButtonIndex,hidden:o.enableApplyButton?false:true,handler:function(B){var A=j.isFunction(o.onApply);if(!A||A&&o.onApply.call(this,B)!==false){B.applyButton.linkbutton("disable")}}}];if(!j.util.likeArrayNotString(o.buttons)){o.buttons=[]}j.array.merge(o.buttons,w);o.buttons=j.array.filter(o.buttons,function(A){return j.util.parseFunction(A.hidden,A)?false:true});j.each(o.buttons,function(B,A){var C=A.handler;if(j.isFunction(C)){A.handler=function(){C.call(this,u)}}});j.array.sort(o.buttons,function(B,A){return(j.isNumeric(B.index)?B.index:0)-(j.isNumeric(A.index)?A.index:0)});if(!o.buttons.length){o.buttons=null}o=u.dialog(o).dialog("options");var x=u.dialog("body"),q=x.children(".dialog-button").each(function(){var A=u.css("border-bottom-color");j(this).addClass("calendar-header").css({height:"auto","border-top-color":A})}),z=q.children("a");if(o.buttonsPlain){z.linkbutton("setPlain",true)}if(!o.iniframe){if(o.href){var s=u.dialog("header").find(".panel-tool a");s.attr("disabled","disabled");z.linkbutton("disable");var v=o.onLoad;o.onLoad=function(){if(j.isFunction(v)){v.apply(this,arguments)}j.util.exec(function(){s.removeAttr("disabled");z.linkbutton("enable")})}}}var r=u.dialog("iframe");if(r.length){c.push({current:r[0],parent:p})}j.extend(u,{options:o,iframe:r,buttons:z,closeButtn:q.children("#close"),saveButton:q.children("#save"),applyButton:q.children("#apply"),save:function(){btnSave.handler()},close:function(){btnClose.handler()},apply:function(){btnApply.handler()}});return u};j.easyui.showDialog=function(o){var q=j.extend({},j.easyui.showDialog.defaults,o);if(q.locale){q.topMost=false}var r=j.util.currentFrame,p=q.topMost?j.util.$.easyui._showDialog:j.easyui._showDialog;return p(q,r)};j.easyui.showOption=function(o,t){o=o||"无数据显示。";var s=j.extend({topMost:j.easyui.showDialog.defaults.topMost,title:"显示 options 值",width:480,height:260,minWidth:360,minHeight:220,autoVCenter:false,autoHCenter:false,enableSaveButton:false,enableApplyButton:false},t||{}),u=s.topMost?j.util.$:j;var r=u('<table class="dialog-options-body" ></table>'),q=u.type(o);if(j.array.contains(["array","object","function"],q)){for(var p in o){r.append('<tr class="dialog-options-row"><td class="dialog-options-cell">'+p+':</td><td class="dialog-options-cell-content">'+j.string.toHtmlEncode(o[p])+"</td></tr>")}}else{r.append('<tr class="dialog-options-row"><td class="dialog-options-cell">options:</td><td class="dialog-options-cell-content">'+j.string.toHtmlEncode(String(o))+"</td></tr>")}s.content=r;return j.easyui.showDialog(s)};function m(s,p){var t=j(s),q=t.dialog("options"),r=t.dialog("contentPanel"),o=r.panel("options");if(p){q.href=p}o.iniframe=q.iniframe;r.panel("refresh",q.href)}function l(p){var o=j.data(p,"dialog");return o?o.contentPanel:null}function n(p){var o=l(p);return o.panel("iframe")}function b(o){o._extensionsDialog={href:o.href,content:o.content,iniframe:o.iniframe,bodyCls:o.bodyCls,bodyStyle:o.bodyStyle};o.bodyCls=null;o.bodyStyle=null;if(o.iniframe){o.href=null;o.content=null;o.iniframe=false}}function a(r){var s=j(r),p=s.dialog("options"),q=l(r),o=p._extensionsDialog?p._extensionsDialog:p._extensionsDialog={href:p.href,content:p.content,iniframe:p.iniframe};p.href=o.href;p.content=o.content;p.iniframe=o.iniframe;p.bodyCls=o.bodyCls;p.bodyStyle=o.bodyStyle;if(q&&q.length){if(p.bodyCls){q.addClass(p.bodyCls)}if(p.bodyStyle){q.css(p.bodyStyle)}}if(p.iniframe){m(r)}}var d=j.fn.dialog;j.fn.dialog=function(o,p){if(typeof o=="string"){return d.apply(this,arguments)}o=o||{};return this.each(function(){var s=j(this),q=j.data(this,"dialog")?true:false,r=q?o:j.extend({},j.fn.dialog.parseOptions(this),o);b(r);d.call(s,r);a(this)})};j.union(j.fn.dialog,d);var f=j.fn.dialog.extensions.methods={options:function(r){var q=j.data(r[0],"dialog"),p=q.options,o=r.panel("options");j.extend(p,{closed:o.closed,collapsed:o.collapsed,minimized:o.minimized,maximized:o.maximized,width:o.width,height:o.height});return p},contentPanel:function(o){return l(o[0])},iframe:function(o){return n(o[0])},refresh:function(p,o){return p.each(function(){m(this,o)})}};var h=j.fn.dialog.extensions.defaults=j.extend({},j.fn.window.extensions.defaults,{});j.extend(j.fn.dialog.defaults,h);j.extend(j.fn.dialog.methods,f);j.easyui.showDialog.defaults={title:"新建对话框",iconCls:"icon-standard-application-form",width:600,height:360,modal:true,collapsible:false,maximizable:false,closable:true,draggable:true,resizable:true,shadow:true,minimizable:false,href:null,autoDestroy:true,locale:null,topMost:false,iniframe:false,enableSaveButton:true,enableApplyButton:true,enableCloseButton:true,saveButtonIndex:101,closeButtonIndex:102,applyButtonIndex:103,onSave:null,onApply:null,onClose:null,saveButtonText:"确定",closeButtonText:"取消",applyButtonText:"应用",saveButtonIconCls:"icon-save",applyButtonIconCls:"icon-ok",closeButtonIconCls:"icon-cancel",buttonsPlain:false}})(jQuery);