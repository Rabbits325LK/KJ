(function(aU,x){aU.fn.treegrid.extensions={};var X=aU.fn.treegrid.methods.update;var ab=aU.fn.treegrid.methods.append;var Z=aU.fn.treegrid.methods.insert;var a4=function(bn,bo){if(!bo||bo.id==x||!bo.row){return}var bl=aU(bn),bm=bl.treegrid("options");if(aU.isFunction(bm.onBeforeUpdate)&&bm.onBeforeUpdate.call(bn,bo.id,bo.row)==false){return}X.call(bl,bl,bo);ao(bl,bm);ah(bl,bm);aC(bl,bm,bo.id,bo.row);if(aU.isFunction(bm.onUpdate)){bm.onUpdate.call(bn,bo.id,bo.row)}};var w=function(bn,bo){if(!bo||!bo.data){return}var bl=aU(bn),bm=bl.treegrid("options");if(aU.isFunction(bm.onBeforeAppend)&&bm.onBeforeAppend.call(bn,bo.parent,bo.data)==false){return}ab.call(bl,bl,bo);ao(bl,bm);ah(bl,bm);aU.each(bo.data,function(){aC(bl,bm,this[bm.idField],this)});if(aU.isFunction(bm.onAppend)){bm.onAppend.call(bn,bo.parent,bo.data)}};var t=function(bn,bo){if(!bo||!bo.data||(!bo.before&&!bo.after)){return}var bl=aU(bn),bm=bl.treegrid("options");if(aU.isFunction(bm.onBeforeInsert)&&bm.onBeforeInsert.call(bn,bo.before,bo.after,bo.data)==false){return}Z.call(bl,bl,bo);ao(bl,bm);ah(bl,bm);aC(bl,bm,bo.data[bm.idField],bo.data);W(bl,bm,bo.data[bm.idField],bm.treeField);if(aU.isFunction(bm.onInsert)){bm.onInsert.call(bn,bo.before,bo.after,bo.data)}};var W=function(bl,bm,br,bn){var bo=bl.treegrid("getCellDom",{field:bn,id:br}),bq=bl.treegrid("getLevel",br),bp=bl.treegrid("getChildren",br);while(bo.find("span.tree-indent,span.tree-hit").length<bq){aU("<span></span>").addClass("tree-indent").prependTo(bo)}aU.each(bp,function(){W(bl,bm,this[bm.idField],bn)})};var aX=function(bn,bo){var bl=aU(bn),bm=bl.treegrid("getRowDom",bo);if(!bm||!bm.length){return 0}return bm.eq(0).parentsUntil("div.datagrid-body","tr.treegrid-tr-tree").length+1};var ac=function(bp,bo){var bn=aU(bp),bm=bn.treegrid("getColumnFields"),bl=bn.treegrid("getColumnFields",true);if(!bl||!bl.length||!aU.array.contains(bm,bo)||aU.array.contains(bl,bo)){return}bn.treegrid("moveColumn",{source:bo,target:bl[bl.length-1],point:"after"})};var F=function(bp,bo){var bn=aU(bp),bm=bn.treegrid("getColumnFields"),bl=bn.treegrid("getColumnFields",true);if(!bm||!bm.length||aU.array.contains(bm,bo)||!aU.array.contains(bl,bo)){return}bn.treegrid("moveColumn",{source:bo,target:bm[0],point:"before"})};var l=function(bO,bo){if(!bo||!bo.source||!bo.target||bo.source==bo.target||!bo.point){return}if(!aU.array.contains(["before","after"],bo.point)){bo.point="before"}var bz=aU(bO);if(bz.treegrid("hasMuliRowHeader")){return}var bA=bz.treegrid("options"),bs,bB,bC=bz.treegrid("getColumnFields"),bK=bz.treegrid("getColumnFields",true);if(aU.array.contains(bC,bo.source)){bs=false}if(bs==x&&aU.array.contains(bK,bo.source)){bs=true}if(aU.array.contains(bC,bo.target)){bB=false}if(bB==x&&aU.array.contains(bK,bo.target)){bB=true}if(bs==x||bB==x){return}if(aU.isFunction(bA.onBeforeMoveColumn)&&bA.onBeforeMoveColumn.call(bO,bo.source,bo.target,bo.point)==false){return}var bv=bz.treegrid("getPanel"),bx=bv.find("div.datagrid-view"),bJ=bx.find("div.datagrid-view1"),bI=bx.find("div.datagrid-view2"),bq=bJ.find("div.datagrid-header table tr.datagrid-header-row"),bp=bI.find("div.datagrid-header table tr.datagrid-header-row"),bH=bJ.find("div.datagrid-body table tr.datagrid-row"),bG=bI.find("div.datagrid-body table tr.datagrid-row"),bt=bs?bq.find("td[field="+bo.source+"]"):bp.find("td[field="+bo.source+"]"),bN=bB?bq.find("td[field="+bo.target+"]"):bp.find("td[field="+bo.target+"]"),bL=bs?bH:bG,bm=bB?bH:bG;if(bL.length!=bm.length){return}bN[bo.point](bt);bm.each(function(bR,bU){var bQ=aU(this),bT=bQ.attr("node-id");var bS=bQ.find("td[field="+bo.target+"]"),bP=aU(bL[bR]).find("td[field="+bo.source+"]");bS[bo.point](bP)});var bF=bz.treegrid("getColumnOption",bo.source),bl=bz.treegrid("getColumnOption",bo.target),bE=bs?bA.frozenColumns[0]:bA.columns[0],br=bB?bA.frozenColumns[0]:bA.columns[0],bu=bA._extensionsTreegrid?bA._extensionsTreegrid:(bA._extensionsTreegrid={});aU.array.remove(bE,bF);var bn=aU.array.indexOf(br,bl);if(bn>-1){aU.array.insert(br,bo.point=="before"?bn:bn+1,bF)}var bw=bA;bA=bz.datagrid("options");bF=bz.datagrid("getColumnOption",bo.source);bl=bz.datagrid("getColumnOption",bo.target);bE=bs?bA.frozenColumns[0]:bA.columns[0];br=bB?bA.frozenColumns[0]:bA.columns[0];aU.array.remove(bE,bF);var bn=aU.array.indexOf(br,bl);if(bn>-1){aU.array.insert(br,bo.point=="before"?bn:bn+1,bF)}bA=bw;if(bs||bB&&bs!=bB){var bM=bz.treegrid("getData");bz.treegrid("loadData",bM)}else{bz.treegrid("fixColumnSize")}if(bs){if(!bB){bn=aU.array.indexOf(bu.fields,bo.target);aU.array.insert(bu.fields,bo.point=="before"?bn:bn+1,bo.source);aU.array.insert(bu.fieldOptions,bo.point=="before"?bn:bn+1,bF);aU.array.insert(bu.fieldOptionsBackup,bo.point=="before"?bn:bn+1,aU.extend({},bF))}}if(!bs){bn=aU.array.indexOf(bu.fields,bo.source);if(bB){aU.array.removeAt(bu.fields,bn);aU.array.removeAt(bu.fieldOptions,bn);aU.array.removeAt(bu.fieldOptionsBackup,bn)}else{var bD=bu.fieldOptions[bn],by=bu.fieldOptionsBackup[bn];aU.array.removeAt(bu.fields,bn);aU.array.removeAt(bu.fieldOptions,bn);aU.array.removeAt(bu.fieldOptionsBackup,bn);bn=aU.array.indexOf(bu.fields,bo.target);aU.array.insert(bu.fields,bo.point=="before"?bn:bn+1,bo.source);aU.array.insert(bu.fieldOptions,bo.point=="before"?bn:bn+1,bD);aU.array.insert(bu.fieldOptionsBackup,bo.point=="before"?bn:bn+1,by)}}if(aU.isFunction(bA.onMoveColumn)){bA.onMoveColumn.call(bO,bo.source,bo.target,bo.point)}};var bc=function(bo,bp){if(!bp||!bp.field||!bp.point){return}if(!aU.array.contains(["before","after"],bp.point)){bp.point="before"}var bn=aU(bo),bl=bn.treegrid("getColumnFields","all"),bm=aU.array.indexOf(bl,bp.field);if(bm==-1||(bp.point=="before"&&bm==0)||(bp.point=="after"&&bm==bl.length-1)){return}var bo=bl[bp.point=="before"?bm-1:bm+1];bn.treegrid("moveColumn",{source:bp.field,target:bo,point:bp.point})};var aR=function(bp,bo){var bm=aU(bp),bn=bm.treegrid("options"),bl=bn._extensionsTreegrid?bn._extensionsTreegrid:(bn._extensionsTreegrid={});if(aU.isFunction(bn.onBeforeDeleteColumn)&&bn.onBeforeDeleteColumn.call(bp,bo)==false){return}aU.fn.datagrid.extensions.removeField(bn,bo,bl);bm.treegrid("getColumnDom",{field:bo,header:true}).remove();if(aU.isFunction(bn.onDeleteColumn)){bn.onDeleteColumn.call(bp,bo)}};var aF=function(bo,bn){var bl=aU(bo),bm=bl.treegrid("getColumnOption",bn);if(bm){bl.treegrid("deleteColumn",bn)}return bm};var R=function(bo,bp){var bl=aU(bo),bm=bl.treegrid("options"),bn=bl.treegrid("getChecked");return aU.array.contains(bn,bp,function(bq){return bq[bm.idField]==bp})};var a9=function(bo,bp){var bl=aU(bo),bm=bl.treegrid("options"),bn=bl.treegrid("getSelections");return aU.array.contains(bn,bp,function(bq){return bq[bm.idField]==bp})};var aO=function(bn,bo){var bm=aU(bn),bl=bm.treegrid("getPanel");return bl.find("div.datagrid-view div.datagrid-body table tr.datagrid-row[node-id="+bo+"]").hasClass("datagrid-row-editing")};var aH=function(bl){var bm=aA(bl);return bm.length?bm[0]:x};var aA=function(bo){var bm=aU(bo),bl=bm.treegrid("getPanel"),bn=bl.find("div.datagrid-view div.datagrid-body table tr.datagrid-row.datagrid-row-editing").map(function(){return aU(this).attr("node-id")}),bp=aU.array.distinct(aU.array.clone(bn));return bp};var r=function(bo,bp){var bm=aU(bo),bl=bm.treegrid("getRoots"),bn=bm.treegrid("find",bp);return bn&&aU.array.contains(bl,bn)};var e=function(bq,br){if(!br||!br.source||!br.target||!br.point){return}if(!aU.array.contains(["append","top","bottom"],br.point)){br.point="append"}var bl=aU(bq),bo=bl.treegrid("options"),bm=bl.treegrid("find",br.source),bp=bl.treegrid("find",br.target);if(!bm||!bp||bm==bp){return}if(aU.isFunction(bo.onBeforeDrop)&&bo.onBeforeDrop.call(bq,bp,bm,br.point)==false){return}if(bl.treegrid("isParent",{id1:br.source,id2:br.target})){return}var bn=bl.treegrid("pop",br.source);switch(br.point){case"append":bl.treegrid("append",{parent:br.target,data:[bn]});break;case"top":bl.treegrid("insert",{before:br.target,data:bn});break;case"bottom":bl.treegrid("insert",{after:br.target,data:bn});break;default:bl.treegrid("append",{parent:br.target,data:[bn]});break}if(bn&&aU.isFunction(bo.onDrop)){bo.onDrop.call(bq,bp,bm,br.point)}};var o=function(bo,bp){if(!bp||!bp.id||!bp.point||!aU.array.contains(["up","upLevel","down","downLevel"],bp.point)){return}var bl=aU(bo),bn=bl.treegrid("options"),bm;switch(bp.point){case"up":bm=bl.treegrid("prevRow",bp.id);break;case"upLevel":bm=bl.treegrid("getParent",bp.id);break;case"down":bm=bl.treegrid("nextRow",bp.id);break;case"downLevel":bm=bl.treegrid("prevRow",bp.id);break;default:break}if(!bm){return}bl.treegrid("moveRow",{target:bm[bn.idField],source:bp.id,point:bp.point=="up"?"top":(bp.point=="downLevel"?"append":"bottom")})};var V=function(bl,bm){if(bk(bl,bm)){return"child"}if(g(bl,bm)){return"parent"}if(s(bl,bm)){return"sibling"}return"normal"};var g=function(bo,bp){var bm=aU(bo),bn=bm.treegrid("find",bp.id2);var bl=bm.treegrid("getChildren",bp.id1);return aU.array.contains(bl,bn)};var bk=function(bo,bp){var bm=aU(bo),bn=bm.treegrid("find",bp.id1);var bl=bm.treegrid("getChildren",bp.id2);return aU.array.contains(bl,bn)};var s=function(bn,bp){var bl=aU(bn),bo=bl.treegrid("getParent",bp.id1),bm=bl.treegrid("getParent",bp.id2);return bo&&bm&&bo==bm};var bg=function(bn,bp){var bl=aU(bn);var bo=bl.treegrid("getRowDom",bp).nextAll("tr.datagrid-row:first"),bm=bo.attr("node-id");if(!bo.length||!bm){return null}return bl.treegrid("find",bm)};var E=function(bn,bp){var bl=aU(bn);var bo=bl.treegrid("getRowDom",bp).prevAll("tr.datagrid-row:first"),bm=bo.attr("node-id");if(!bo.length||!bm){return null}return bl.treegrid("find",bm)};var bh=function(bo,bp){var bl=aU(bo),bm=bl.treegrid("options");if(bl.treegrid("isRoot",bp)){return bl.treegrid("getRoots")}var bn=bl.treegrid("getParent",bp);if(!bn){return bl.treegrid("getRoots")}return bl.treegrid("getNearChildren",bn[bm.idField])};var aT=function(bo,bp){var bm=aU(bo),bn=bm.treegrid("options"),bl=bm.treegrid("getChildren",bp);return aU.array.filter(bl,function(bq){return bm.treegrid("getParent",bq[bn.idField])[bn.idField]==bp})};var aw=function(bo){var bl=aU(bo),bn=bl.treegrid("options");bl.treegrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable({disabled:false,revert:true,cursor:"default",deltaX:10,deltaY:5,proxy:function(br){var bq=aU(br),bu=bq.attr("node-id"),bs=bl.treegrid("getRowDom",bu).clone();var bp=aU("<tr></tr>").addClass("datagrid-row datagrid-row-selected");aU("<td><span class='tree-dnd-icon tree-dnd-no' ></span></td>").appendTo(bp);var bt=bs.find("td").each(function(bv){if(bv<6){bp.append(this)}});if(bt.length>6){aU("<td>...</td>").css("width","40px").appendTo(bp)}return aU("<table></table>").addClass("tree-node-proxy").appendTo("body").append(bp).hide()},onBeforeDrag:function(bq){var bp=aU(this),bs=bp.attr("node-id"),br=bl.treegrid("find",bs);if(aU.isFunction(bn.onBeforeDrag)&&bn.onBeforeDrag.call(bo,br)==false){return false}if(bq.which!=1){return false}if(bq.target.type=="checkbox"){return false}bl.treegrid("getRowDom",{id:bs,cascade:true}).droppable({accept:"no-accept"})},onStartDrag:function(){var bp=aU(this),br=bp.attr("node-id"),bq=bl.treegrid("find",br);bp.draggable("proxy").css({left:-10000,top:-10000});if(aU.isFunction(bn.onBeforeDrag)){bn.onStartDrag.call(bo,bq)}},onStopDrag:function(){var bp=aU(this),br=bp.attr("node-id"),bq=bl.treegrid("find",br);bl.treegrid("getRowDom",{id:br,cascade:true}).droppable({accept:"tr.datagrid-row"});if(aU.isFunction(bn.onStopDrag)){bn.onStopDrag.call(bo,bq)}},onDrag:function(bt){var bq=bt.pageX,bs=bt.pageY,bp=bt.data.startX,br=bt.data.startY;var bu=Math.sqrt((bq-bp)*(bq-bp)+(bs-br)*(bs-br));if(bu>15){aU(this).draggable("proxy").show()}this.pageY=bt.pageY}}).droppable({accept:"tr.datagrid-row",onDragEnter:function(by,bp){var bq=aU(this),bz=aU(bp),bB=bq.attr("node-id"),bv=bz.attr("node-id"),bA=bl.treegrid("find",bB),bx=bl.treegrid("find",bv),bu=bl.treegrid("getRowDom",bB),bt=bu.find("td"),bs=bu.find("td[field="+bn.treeField+"]");var br=bq.data("dnd"),bw={droper:bq,drager:bz,droperId:bB,dragerId:bv,droperRow:bA,dragerRow:bx,droperRowDom:bu,mark:bt,treeFieldDom:bs};if(!br){bq.data("dnd",bw)}else{aU.extend(br,bw)}if(aU.isFunction(bn.onDragEnter)&&bn.onDragEnter.call(bo,bA,bx)==false){bm(bz,false);bt.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom");bs.removeClass("datagrid-header-cell-append")}},onDragOver:function(bx,bp){var bq=aU(this),br=bq.data("dnd"),bz=br.drager,bB=br.droperId,bv=br.dragerId,bA=br.droperRow,bw=br.dragerRow,bu=br.mark,bs=br.treeFieldDom;if(bq.droppable("options").disabled){return}var bt=bp.pageY,by=bq.offset().top,bC=by+bq.outerHeight();bm(bz,!bl.treegrid("isParent",{id1:bv,id2:bB}));bu.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom");bs.removeClass("datagrid-header-cell-append");if(bt>by+(bC-by)/2){if(bC-bt<5){bu.addClass("datagrid-header-cell-bottom")}else{bs.addClass("datagrid-header-cell-append")}}else{if(bt-by<5){bu.addClass("datagrid-header-cell-top")}else{bs.addClass("datagrid-header-cell-append")}}if(bn.onDragOver.call(bo,bA,bw)==false){bm(bz,false);bu.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom");bs.removeClass("datagrid-header-cell-append");bq.droppable("disable")}},onDragLeave:function(bv,bp){var bq=aU(this),br=bq.data("dnd"),bw=br.drager,bx=br.droperRow,bu=br.dragerRow,bt=br.mark,bs=br.treeFieldDom;bm(bw,false);bt.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom");bs.removeClass("datagrid-header-cell-append");if(aU.isFunction(bn.onDragLeave)){bn.onDragLeave.call(bo,bx,bu)}},onDrop:function(bv,bp){var bq=aU(this),br=bq.data("dnd"),bx=br.droperId,bu=br.dragerId,bt=br.mark,bs=br.treeFieldDom,bw=bs.hasClass("datagrid-header-cell-append")?"append":(bt.hasClass("datagrid-header-cell-top")?"top":"bottom");bl.treegrid("moveRow",{target:bx,source:bu,point:bw});bt.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom");bs.removeClass("datagrid-header-cell-append")}});bn.dndRow=true;function bm(br,bq){var bp=br.draggable("proxy").find("span.tree-dnd-icon");bp.removeClass("tree-dnd-yes tree-dnd-no").addClass(bq?"tree-dnd-yes":"tree-dnd-no")}};var bi=function(bn){var bl=aU(bn),bm=bl.treegrid("options");bl.treegrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable("disable");bm.dndRow=false};var G=function(bp,bl){var bm=aU(bp),bo=bm.treegrid("getRoots"),bn=bm.treegrid("options");bo=bo&&bo.length?bo:[];return bl?aU.array.reduce(bo,function(br,bs,bq){br.push(bs);var bt=bm.treegrid("getChildren",bs[bn.idField]);if(bt&&bt.length){aU.array.merge(br,bt)}return br},[]):bo};var z=function(bp,bq){bq=aU.isPlainObject(bq)?bq:{field:bq,cascade:false};var bo=bq.field,bl=bq.cascade,bm=aU(bp),bn=bm.treegrid("getRows",bl);return aU.array.map(bn,function(br){return br[bo]})};var bf=function(br,bp){bp=aU.isPlainObject(bp)?bp:{id:bp,cascade:false};var bn=bp.id,bs=bp.cascade?true:false,bt=aU(br),bl=bt.treegrid("options"),bm=bt.treegrid("getPanel"),bq=bm.find(".datagrid-view .datagrid-body tr.datagrid-row[node-id="+bn+"]");if(bs){var bo=bt.treegrid("getChildren",bn);aU.each(bo,function(bu,bw){var bv=bf(br,bw[bl.idField]);bq=bq.add(bv)})}return bq};var M=function(bl,bm){return aU(bl).treegrid("find",bm)};var aj=function(bn,bo){if(!bo||!bo.field||bo.id==null||bo.id==x){return aU()}var bl=aU(bn),bm=bl.treegrid("getRowDom",bo.id);return bm.find("td[field="+bo.field+"] .datagrid-cell")};var ap=function(bm,bo){if(!bo||!bo.field||bo.id==null||bo.id==x){return x}var bl=aU(bm),bn=bl.treegrid("find",bo.id);return bn[bo.field]};var bb=function(bn,bo){var bm=aU(bn),bl=bm.treegrid("getCellDom",bo);return bl&&bl.length?bl.text():x};var K=function(br,bs){bs=aU.isPlainObject(bs)?bs:{field:bs,cascade:false};var bq=bs.field,bm=bs.cascade,bn=aU(br),bl=bn.treegrid("getColumnFields","all");if(!aU.array.contains(bl,bq)){return[]}var bp=bn.treegrid("getRows",bm),bo=aU.array.clone(bp);aU.array.distinct(bo,function(bu,bt){return bu[bq]==bt[bq]});return bo};var a0=function(bq,br){br=aU.isPlainObject(br)?br:{field:br,cascade:false};var bp=br.field,bm=br.cascade,bn=aU(bq),bl=bn.treegrid("getColumnFields","all");if(!aU.array.contains(bl,bp)){return[]}var bo=bn.treegrid("getColumnData",{field:bp,cascade:bm});aU.array.distinct(bo,function(bt,bs){return bt==bs});return bo};var j=aU.fn.treegrid.methods.find;var aZ=function(bo,bp,bm){var bl=bm||aU(bo);if(!aU.isFunction(bp)){return j.call(bl,bl,bp)}var bn=bl.treegrid("getRows",true);return aU.array.first(bn,bp)};var a6=function(bn,bo){var bm=aU(bn),bl;if(aU.isFunction(bo)){bl=aU.array.filter(bm.treegrid("getRows",true),bo)}else{if(aU.array.likeArray(bo)&&!aU.util.isString(bo)){bl=aU.array.map(bo,function(bp){return aZ(bn,bp,bm)});bl=aU.array.filter(bl,function(bp){return bp!=x&&bp!=null})}else{bl=[aZ(bn,bo,bm)]}}return bl};var aJ=function(bu,bq,bm,bz,bv,bt){var bx=bm||aU(bu),bl=bz||bx.treegrid("options"),bw=aU.isFunction(bq),bp=bw?aZ(bu,bq,bx):null,bn=bw?(bp?bp[bl.idField]:null):(aU.isPlainObject(bq)&&(bl.idField in bq)?bq[bl.idField]:bq);if(bn==null||bn==x){return}var bs=bx.treegrid("getRowDom",{id:bn,cascade:true}),bt=(bt==null||bt==x||bt==true)?true:false;if(bs.length){var by=bw?bp:bx.treegrid("find",bn),br=bv||(bl._extensionsTreegrid?bl._extensionsTreegrid:(bl._extensionsTreegrid={}));br.filterData=aU.isArray(br.filterData)?br.filterData:br.filterData=[];bs.show();aU.array.remove(br.filterData,by);var bo=bx.treegrid("getChildren",bn);aU.each(bo,function(){aU.array.remove(br.filterData,this)});if(bt){a2(bx,bl,br,rows)}}};var S=function(bt,bp,bm,by,bu,bs){var bw=bm||aU(bt),bl=by||bw.treegrid("options"),bv=aU.isFunction(bp),bo=bv?aZ(bt,bp,bw):null,bn=bv?(bo?bo[bl.idField]:null):(aU.isPlainObject(bp)&&(bl.idField in bp)?bp[bl.idField]:bp);if(bn==null||bn==x){return}var br=bw.treegrid("getRowDom",{id:bn,cascade:true}),bs=(bs==null||bs==x||bs==true)?true:false;if(br.length){var bx=bv?bo:bw.treegrid("find",bn),bq=bu||(bl._extensionsTreegrid?bl._extensionsTreegrid:(bl._extensionsTreegrid={}));bq.filterData=aU.isArray(bq.filterData)?bq.filterData:bq.filterData=[];bw.treegrid("unselectRow",{id:bn,cascade:true}).treegrid("uncheckRow",{id:bn,cascade:true});br.hide();aU.array.unique(bq.filterData,bx,bw.treegrid("getChildren",bn));if(bs){a2(bw,bl,bq,rows)}}};var aQ=function(bq,bn){var bs=aU(bq),bl=bs.treegrid("options"),bt=bs.treegrid("getRows",true),bp,bo=bl._extensionsTreegrid?bl._extensionsTreegrid:(bl._extensionsTreegrid={});if(bn===true){bo.filterData=[];var bm=bs.treegrid("getPanel"),br=bm.find("div.datagrid-header-filter-item-icon");bm.find(".datagrid-view .datagrid-body tr.datagrid-row").show();aD(br,"tree-checkbox1");h(bs,bl)}else{if(aU.isFunction(bn)){bp=aU.array.filter(bt,bn);bp=aU.array.map(bp,function(bu){return bu[bl.idField]})}else{if(aU.array.likeArray(bn)&&!aU.util.isString(bn)){bp=bn}else{bp=[bn]}}}if(bp){aU.each(bp,function(bu,bv){aJ(bq,bv,bs,bl,bo,false)});a2(bs,bl,bo,bs.treegrid("getRows"))}};var f=function(bq,bn){var bs=aU(bq),bl=bs.treegrid("options"),bt=bs.treegrid("getRows",true),bp,bo=bl._extensionsTreegrid?bl._extensionsTreegrid:(bl._extensionsTreegrid={});if(bn===true){bs.treegrid("unselectAll").treegrid("uncheckAll");bo.filterData=aU.array.clone(bt);var bm=bs.treegrid("getPanel"),br=bm.find("div.datagrid-header-filter-item-icon");bm.find(".datagrid-view .datagrid-body tr.datagrid-row").hide();aD(br,"tree-checkbox0");h(bs,bl)}else{if(aU.isFunction(bn)){bp=aU.array.filter(bt,bn);bp=aU.array.map(bp,function(bu){return bu[bl.idField]})}else{if(aU.array.likeArray(bn)&&!aU.util.isString(bn)){bp=bn}else{bp=[bn]}}}if(bp){aU.each(bp,function(bu,bv){S(bq,bv,bs,bl,bo,false)});a2(bs,bl,bo,bs.treegrid("getRows"))}};var ae=function(bq,bm){var bo=aU(bq),bp=bo.treegrid("options"),bn=bp._extensionsTreegrid?bp._extensionsTreegrid:(bp._extensionsTreegrid={});if(bm){return bn.filterData}var bl=bo.treegrid("getRoots");return aU.array.filter(bn.filterData,function(br){return aU.array.contains(bl,br)})};var aN=function(bq,bl){var bn=aU(bq),bo=bn.treegrid("options"),bp=bn.treegrid("getRows",bl),bm=bo._extensionsTreegrid?bo._extensionsTreegrid:(bo._extensionsTreegrid={});return aU.array.filter(bp,function(br){return aU.array.contains(bm.filterData,br)?false:true})};var ag=aU.fn.treegrid.methods.remove;var av=function(bn,bp){var bl=aU(bn),bm=bl.treegrid("options"),bo=bl.treegrid("find",bp);if(bo&&aU.isFunction(bm.onBeforeRemove)&&bm.onBeforeRemove.call(bn,bo)!=false){ag.call(bl,bl,bp);ao(bl,bm);if(aU.isFunction(bm.onRemove)){bm.onRemove.call(bn,bo)}}};var k=function(bo,bq){var bl=aU(bo);if(!aU.isFunction(bq)){bl.treegrid("remove",bq)}var bn=bl.treegrid("getRows",true),bm=bl.treegrid("options"),bp=aU.array.first(bn,bq),br=bp?bp[bm.idField]:null;bl.treegrid("remove",br)};var Y=function(bq,br){var bl=aU.array.likeArray(br)&&!aU.util.isString(br);if(bl){aU.each(br,function(bs,bt){k(bq,bt)});return}if(aU.isFunction(br)){var bm=aU(bq),bn=bm.treegrid("options"),bp=bm.treegrid("getRows",true),bo=aU.array.filter(bp,br);aU.each(function(){var bs=aZ(bq,this[bn.idField],bm);if(bs!=null&&bs!=x){bm.treegrid("remove",this[bn.idField])}})}};var aa=function(bn,bo){if(bo&&bo.field&&bo.title){var bl=aU(bn),bm=bl.treegrid("getColumnOption",bo.field);bm.title=bo.title;bl.datagrid("setColumnTitle",bo)}};var be=aU.fn.treegrid.methods.select;var H=aU.fn.treegrid.methods.unselect;var ay=function(bo,bp){bp=aU.isPlainObject(bp)?bp:{id:bp,cascade:false};var bq=bp.id,bl=bp.cascade?true:false,bm=aU(bo);be.call(bm,bm,bq);if(bl){var bn=bm.treegrid("options");aU.each(bm.treegrid("getChildren",bq),function(){be.call(bm,bm,this[bn.idField])})}};var b=function(bo,bp){bp=aU.isPlainObject(bp)?bp:{id:bp,cascade:false};var bq=bp.id,bl=bp.cascade?true:false,bm=aU(bo);H.call(bm,bm,bq);if(bl){var bn=bm.treegrid("options");aU.each(bm.treegrid("getChildren",bq),function(){H.call(bm,bm,this[bn.idField])})}};var L=function(bo,bp){bp=aU.isPlainObject(bp)?bp:{id:bp,cascade:false};var bq=bp.id,bl=bp.cascade?true:false,bm=aU(bo);bm.datagrid("checkRow",bq);if(bl){var bn=bm.treegrid("options");aU.each(bm.treegrid("getChildren",bq),function(){bm.datagrid("checkRow",this[bn.idField])})}};var aL=function(bo,bp){bp=aU.isPlainObject(bp)?bp:{id:bp,cascade:false};var bq=bp.id,bl=bp.cascade?true:false,bm=aU(bo);bm.datagrid("uncheckRow",bq);if(bl){var bn=bm.treegrid("options");aU.each(bm.treegrid("getChildren",bq),function(){bm.datagrid("uncheckRow",this[bn.idField])})}};var A=function(bs,bt){var bu=aU(bs),bl=bu.treegrid("options"),bq=bl._extensionsTreegrid?bl._extensionsTreegrid:(bl._extensionsTreegrid={}),bm=bu.treegrid("getPanel"),bp="div.datagrid-view div.datagrid-header tr.datagrid-header-row div.datagrid-header-filter-container";if(!bt){var bn=bm.find(bp),bo=bn.length,br=0;bn.slideUp("slow",function(){if(++br==bo){aM(bu,bl);bl.columnFilter=bt}})}else{bl.columnFilter=bt;ao(bu,bl,bq);aU.util.exec(function(){bm.find(bp).hide().slideDown("slow")})}};var u=function(br,bs){var bm=aU(br);if(aU.util.isBoolean(bs)){bm.treegrid(bs?"showRows":"hideRows",true);return}if(!bs||!bs.field){return}var bq=bs.field,bo=bs.value,bl=aU.array.likeArray(bo)&&!aU.util.isString(bo),bp=bl?function(bt){return aU.array.contains(bo,bt[bq])}:function(bt){return bo==bt[bq]},bn=bm.treegrid("findRows",bp);bm.treegrid(bs.selected?"showRows":"hideRows",bn)};var ad=function(bo,bp){var bm=aU(bo),bn=bm.treegrid("options"),bl=bn._extensionsTreegrid?bn._extensionsTreegrid:(bn._extensionsTreegrid={});bn.offset=bl.offset=aU.fn.datagrid.extensions.parseOffset(bp);bm.datagrid("setOffset",bn.offset)};var aB=function(br,bp){var bv=aU(br),bm=bv.treegrid("getPanel"),bl=bv.treegrid("options"),bo=bl.treeField,bw,bt,bu=bp,bn=false,bq=true,bs;if(aU.isPlainObject(bp)){bu=bp.value;bt=bp.field;bn=bp.regular;bq=bp.ignoreCase;bw=bm.find("div.datagrid-body tr.datagrid-row td["+(bt?"field="+bt:"field")+"] div.datagrid-cell")}else{bw=bm.find("div.datagrid-body tr.datagrid-row td[field] div.datagrid-cell")}bs=bn?new RegExp(bu,bq?"gm":"igm"):bu;bw.each(function(){var bx=aU(this),bA=bx.parent(),by=bA.attr("field");if(by==bo){bx=bx.find("span.tree-title")}bx.find("span.datagrid-cell-hightlight").replaceWith(function(){return aU(this).text()});if(!bu){return}var bz=bx.html();if(!bz){return}bx.html(aU.string.replaceAll(bz,bu,"<span class='datagrid-cell-hightlight'>"+bu+"</span>"))})};var aG=function(bm,bl){bl=aU.string.toBoolean(bl);alert("导出"+(bl?"全部":"当前页")+"数据")};var ah=aU.fn.treegrid.extensions.initRowDndExtensions=function(bl,bm){bm=bm||bl.treegrid("options");if(bm.dndRow){bl.treegrid("enableRowDnd")}};function ao(bw,bl,bn){bn=bn||(bl._extensionsTreegrid?bl._extensionsTreegrid:(bl._extensionsTreegrid={}));aU.fn.datagrid.extensions.initColumnExtendProperties(bw,bn);var bo=bw.treegrid("getData"),br=bn.oldData;if(bo!=br){bn.filterData=[]}aM(bw,bl);h(bw,bl);if(!bl.columnFilter){return}bn.oldData=bo;var bq=bw.treegrid("getPanel").find("div.datagrid-view div.datagrid-header"),bs=bq.find("table.datagrid-htable tr.datagrid-header-row"),bm=bs.find("td[field]").filter(function(){var bz=aU(this),by=bz.attr("colspan");return(!by||by=="1")&&!bz.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false}),bv=bl.columnFilter=aU.extend({panelHeight:100,position:"top"},bl.columnFilter),bp=aU.array.contains(["top","bottom"],bv.position)?bv.position:"top",bt=bv.panelHeight=aU.isNumeric(bv.panelHeight)&&bv.panelHeight>=60?bv.panelHeight:60,bu=bq.height(),bx=bw.treegrid("getRows");bm.each(function(){var bE=aU(this).addClass("datagrid-header-filter").removeClass("datagrid-header-filter-top datagrid-header-filter-bottom"),by=bE.find("div.datagrid-cell").addClass("datagrid-header-filter-cell"),bD=bE.attr("field"),bC=bw.treegrid("getColumnOption",bD),bB=bC.width,bA=aU("<hr />").addClass("datagrid-header-filter-line")[bp=="top"?"prependTo":"appendTo"](this),bz=aU("<div></div>").attr("field",bD).addClass("datagrid-header-filter-container").css({height:bv.panelHeight,width:bB})[bp=="top"?"prependTo":"appendTo"](this);bE.addClass(bp=="top"?"datagrid-header-filter-top":"datagrid-header-filter-bottom");if(bD){ar(bw,bl,bn,bz,bC,bx,bm)}});if(bn.filterData&&bn.filterData.length){bw.treegrid("hideRows",bn.filterData)}else{a2(bw,bl,bn,bx,bm)}}function aM(bn,bo){if(!bo.columnFilter){return}var bm=bn.treegrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function(){var bq=aU(this),bp=bq.attr("colspan");return(!bp||bp=="1")&&!bq.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false});bm.removeClass("datagrid-header-filter datagrid-header-filter-top datagrid-header-filter-bottom").find("div.datagrid-cell").removeClass("datagrid-header-filter-cell");bm.find("hr.datagrid-header-filter-line,div.datagrid-header-filter-container").remove();var bl=bn.treegrid("getColumnFields","all");bn.datagrid("fixColumnSize",bl[bl.length-1])}function ar(bv,bl,bq,bn,bt,bw,bm){if(!bt.filterable){return}var bu=bt.field,bs=bv.treegrid("getDistinctColumnData",bu),bo=aU.array.contains(["checkbox","livebox","caps","lower","none"],bt.filter)?bt.filter:"checkbox",br=bt.precision,bp=bt.step;switch(bo){case"checkbox":B(bv,bl,bq,bn,bu,bw,bs);break;case"livebox":O(bv,bl,bn,bu,bw);break;case"caps":i(bv,bl,bn,bu,bp,br,bw,bs,"<=",bl.columnFilter.panelHeight,bm);break;case"lower":i(bv,bl,bn,bu,bp,br,bw,bs,">=",bl.columnFilter.panelHeight,bm);break;case"none":break}}function B(bo,bp,bn,bm,br,bq,bl){aU.each(bl,function(bt,bx){var bw=aU("<div></div>").addClass("datagrid-header-filter-item").attr("text",bx).appendTo(bm),bs=aU("<div></div>").addClass("datagrid-header-filter-item-text").text(bx).appendTo(bw),bv=aU("<div></div>").addClass("datagrid-header-filter-item-icon").appendTo(bw),bu=function(){var bA=aU.array.filter(bq,function(bB){return bB[br]==bx}),bz=bo.treegrid("getHiddenRows"),by=aU.array.filter(bz,function(bB){return bB[br]==bx});bo.treegrid(by.length?"showRows":"hideRows",aU.array.map(bA,function(bB){return bB[bp.idField]}))};bw.click(bu)})}function O(bo,bp,bl,br,bq){aU("<div></div>").addClass("datagrid-header-filter-livebox-text").text("模糊过滤：").appendTo(bl);var bm=aU("<input />").addClass("datagrid-header-filter-livebox").appendTo(bl);var bn=aU("<a />").linkbutton({plain:true,iconCls:"icon-search"}).appendTo(bl).click(function(){bo.treegrid("showRows",true);var bt=bm.val();if(aU.string.isNullOrEmpty(bt)){bm.focus();return}var bs=aU.array.filter(bq,function(bu){return String(bu[br]).indexOf(bt)==-1});bo.treegrid("hideRows",aU.array.map(bs,function(bu){return bu[bp.idField]}));bm.focus()});aU("<a />").linkbutton({plain:true,iconCls:"icon-undo"}).appendTo(bl).click(function(){var bs=bm.val();if(bs){bm.val("").focus();bn.click()}else{bm.focus()}});bm.keypress(function(bs){if(bs.which==13){bn.click()}})}function i(by,bz,bx,bn,bq,bE,bt,bG,bo,bl,bF){var bs=aU.array.map(bG,function(bH){bH=parseFloat(bH);return aU.isNumeric(bH)?bH:0}),bC=bs.length?aU.array.min(bs):0,bD=bs.length?aU.array.max(bs):0,bw=bs.length?aU.array.max(bs,function(bI,bH){return aU.util.compare(aU.number.precision(bI),aU.number.precision(bH))}):0,bu=bs.length?aU.number.precision(bw):0,bA=bl-45,bp=aU("<div></div>").addClass("datagrid-header-filter-itemwrap").text(bo).appendTo(bx),br=aU("<div></div>").addClass("datagrid-header-filter-sliderwrap").css({height:bA+10})[bo=="<="?"appendTo":"prependTo"](bx),bv=aU("<input />").addClass("datagrid-header-filter-numeric").appendTo(bp),bB=aU("<input />").addClass("datagrid-header-filter-slider").appendTo(br),bm=function(bI,bH){a(by,bz,bn,bt,bI,bo,bv,bB,bF)};bv.numberbox({value:bo=="<="?bD:bC,min:bC,max:bD,precision:bE,onChange:bm,height:18});bv.keypress(function(bH){if(bH.which==13){var bI=bv.val();bv.numberbox("setValue",aU.isNumeric(bI)?bI:0)}});bB.slider({height:bA,mode:"v",showTip:true,value:bo=="<="?bD:bC,min:bC,max:bD,rule:[bC,"|",bD],step:bq,onComplete:bm,tipFormatter:function(bH){return aU.number.round(bH||0,bu)}})}function a(bv,bm,bs,bw,bu,br,bt,bn,bq){var bl=bq||bv.treegrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function(){var by=aU(this),bx=by.attr("colspan");return(!bx||bx=="1")&&!by.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false});var bp=bl.filter(function(){return aU(this).attr("field")==bs});bt=bt?bt:bp.find(".datagrid-header-filter-numeric");bn=bn?bn:bp.find(".datagrid-header-filter-slider");var bo=aU.array.filter(bw,function(bx){bx=parseFloat(bx[bs]);bx=aU.isNumeric(bx)?bx:0;return br==">="?(bx<bu):(bx>bu)});bv.treegrid("showRows",true).treegrid("hideRows",aU.array.map(bo,function(bx){return bx[bm.idField]}));bt.numberbox("setValue",bu);bn.slider("setValue",bu)}function a2(bn,bo,bm,bp,bl){h(bn,bo);if(!bo.columnFilter){return}bl=bl||bn.treegrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function(){var br=aU(this),bq=br.attr("colspan");return(!bq||bq=="1")&&!br.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false});bl.each(function(){var br=aU(this),bq=br.attr("field");T(bn,bm,bp,br,bq)})}function h(bo,bq){if(!bq.pagination){return}var bm=bo.treegrid("getPager");if(bm&&bm.length){var bl=bo.treegrid("getVisibleRows").length,bp=bo.datagrid("getRows").length,bn=bl<bp?true:false,br=bm.find("div.pagination-visiblerows");if(bq.showFilterText==false||((bq.showFilterText==null||bq.showFilterText==x)&&!bn)){return br.remove()}if(br.length){br.html("当前页显示"+bl+"/"+bp+"行")}else{bm.find("div.pagination-info").before('<div class="pagination-visiblerows">当前页显示'+bl+"/"+bp+"行</div>")}}}function T(bn,bm,bp,bs,br){var bq=bn.treegrid("getColumnOption",br),bl=bq.precision,bo=aU.array.contains(["checkbox","livebox","caps","lower","none"],bq.filter)?bq.filter:"checkbox";switch(bo){case"checkbox":an(bn,bm,bp,bs,br);break;case"livebox":aI(bn,bm,bp,bs,br);break;case"caps":aq(bn,bm,bp,bs,br);break;case"lower":al(bn,bm,bp,bs,br);break;case"none":break}}function an(bm,bl,bn,bp,bo){bp.find("div.datagrid-header-filter-item").each(function(){var bu=aU(this),bw=bu.attr("text"),bs=bu.find("div.datagrid-header-filter-item-icon");var bt=aU.array.sum(bn,function(bx){return bx[bo]==bw?1:0}),bv=bm.treegrid("getHiddenRows"),bq=aU.array.sum(bv,function(bx){return bx[bo]==bw?1:0}),br=bq==0?"tree-checkbox1":(bq>=bt?"tree-checkbox0":"tree-checkbox2");aU.easyui.tooltip.init(bu,{content:(aU.string.isNullOrEmpty(bw)?"空白":bw)+": 共"+bt+"个元素"});aD(bs,br)})}function aD(bm,bl){bm.removeClass("tree-checkbox0 tree-checkbox1 tree-checkbox2").addClass(bl)}function aI(bm,bl,bn,bp,bo){}function aq(bm,bl,bn,bp,bo){}function al(bm,bl,bn,bp,bo){}function au(bm,bo,bl){var bn=bm.datagrid("options");bl.onHeaderContextMenuBak=bo.onHeaderContextMenu;bo.onHeaderContextMenu=bn.onHeaderContextMenu=function(bs,br){if(aU.isFunction(bl.onHeaderContextMenuBak)){bl.onHeaderContextMenuBak.apply(this,arguments)}if(!bo.enableHeaderContextMenu){return}var bq=aU.fn.datagrid.extensions.parseContextMenuEventData(bm,bo,bs),bp=a1(bm,bo,bl,bs,br,bq);aU.easyui.showMenu({items:bp,left:bs.pageX,top:bs.pageY,hideDisabledMenu:bo.hideDisabledMenu});bs.preventDefault()}}function ak(bm,bn,bl){bl.onContextMenuBak=bn.onContextMenu;bn.onContextMenu=function(bq,br){if(aU.isFunction(bl.onContextMenuBak)){bl.onContextMenuBak.apply(this,arguments)}if(bn.selectOnRowContextMenu){bm.treegrid("select",br[bn.idField])}if(!bn.enableRowContextMenu){return}var bp=aU.fn.datagrid.extensions.parseContextMenuEventData(bm,bn,bq),bo=a3(bm,bn,bl,bq,br,bp);if(bn.autoBindDblClickRow&&bn.dblClickRowMenuIndex>=0&&aU.util.likeArray(bn.rowContextMenu)&&!aU.util.isString(bn.rowContextMenu)&&bn.rowContextMenu.length>bn.dblClickRowMenuIndex){bo[bn.dblClickRowMenuIndex].bold=true}aU.easyui.showMenu({items:bo,left:bq.pageX,top:bq.pageY,hideDisabledMenu:bn.hideDisabledMenu});bq.preventDefault()}}function aW(bm,bn,bl){if(!bn.enableHeaderClickMenu){return}bm.treegrid("getPanel").find(".datagrid-view .datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function(){var bp=aU(this),bo=bp.attr("colspan");return(!bo||bo=="1")&&!bp.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false}).find("div.datagrid-cell").each(function(){n(bm,bn,bl,this)})}function n(bn,bo,bm,bl){var bp=aU("<span class='s-btn-downarrow datagrid-header-cell-arrow'>&nbsp;</span>").click(function(bu){var bx=aU(this),bt=bx.offset(),bz=bx.outerHeight(),bw=bx.parent().parent().attr("field"),by=aU.fn.datagrid.extensions.parseContextMenuEventData(bn,bo,bu),bv=a1(bn,bo,bm,bu,bw,by);var bs=aU.easyui.showMenu({items:bv,left:bt.left,top:bt.top+bz}),br=bs.menu("options"),bq=br.onHide;bp.hidable=false;br.onHide=function(){bp.hidable=true;bp.removeClass("datagrid-header-cell-arrow-show");bq.apply(this,arguments)};return false}).prependTo(bl);aU(bl).off(".hoverArrow").on({"mouseenter.hoverArrow":function(){bp.addClass("datagrid-header-cell-arrow-show")},"mouseleave.hoverArrow":function(){if(!aU.util.isBoolean(bp.hidable)||bp.hidable){bp.removeClass("datagrid-header-cell-arrow-show")}}})}function a1(bt,bl,bm,bo,bq,bs){var bp=[],bn=aU.util.likeArray(bl.headerContextMenu)&&!aU.util.isString(bl.headerContextMenu)?bl.headerContextMenu:[];if(bn.length){aU.array.merge(bp,bn)}var br=U(bt,bl,bm,bo,bq,bs);if(br.length){aU.array.merge(bp,"-",br)}bp=aU.fn.datagrid.extensions.parseHeaderContextMenuMap(bo,bq,bs,bp,bt);if(bp[0]=="-"){aU.array.removeAt(bp,0)}return bp}function a3(bs,bl,bm,bo,bt,br){var bp=[],bn=aU.util.likeArray(bl.rowContextMenu)&&!aU.util.isString(bl.rowContextMenu)?bl.rowContextMenu:[];if(bn.length){aU.array.merge(bp,bn)}var bq=bj(bs,bl,bm,bo,bt,br);if(bq.length){aU.array.merge(bp,"-",bq)}bp=aU.fn.treegrid.extensions.parseRowContextMenuMap(bo,bt,br,bp,bs);if(bp[0]=="-"){aU.array.removeAt(bp,0)}return bp}function U(bB,bl,bo,br,bv,by){var bm=[],bn=bl.exportMenu,bu=bB.treegrid("getColumnOption",bv),bq=bu.sortable;if(typeof bn=="object"){bn=aU.extend({current:false,all:false,submenu:true},bn)}var bA={text:"升序",iconCls:"icon-standard-hmenu-asc",disabled:bq!=true,handler:function(){return bB.treegrid("sort",{sortName:bv,sortOrder:"asc"})}};var bz={text:"降序",iconCls:"icon-standard-hmenu-desc",disabled:bq!=true,handler:function(){return bB.treegrid("sort",{sortName:bv,sortOrder:"desc"})}};var bx={text:"显示/隐藏列",iconCls:"icon-standard-application-view-columns",disabled:false,children:[{text:"显示全部列",iconCls:function(){var bC=bo.fields?bo.fields.length:0;var bD=aU.array.sum(bo.fieldOptions,function(bE){return bE.hidden?0:1});return bD>=bC?"tree-checkbox1":(bD==0?"tree-checkbox0":"tree-checkbox2")},hideOnClick:false,handler:function(bG,bF,bE,bC,bD,bH){aU.each(bo.fields,function(){bC.treegrid("showColumn",this)});aU(this).parent().children("div.menu-item:not(:eq(1))").each(function(){bH.menu("setIcon",{target:this,iconCls:"tree-checkbox1"});bH.menu("enableItem",this)})}},{text:"还原默认",iconCls:"icon-standard-application-view-tile",hideOnClick:false,handler:function(bG,bF,bE,bC,bD,bI){aU.each(bo.fieldOptionsBackup,function(){bC.treegrid(this.hidden==true?"hideColumn":"showColumn",this.field)});var bH=aU(this).parent();bH.children("div.menu-item:gt(1)").each(function(){var bK=aU(this).text(),bJ=aU.array.first(bo.fieldOptions,function(bL){return bL.title==bK});if(bJ){bI.menu("setIcon",{target:this,iconCls:bJ.hidden?"tree-checkbox0":"tree-checkbox1"})}bI.menu("enableItem",this)});bH.children("div.menu-item:first").each(function(){var bJ=bo.fields?bo.fields.length:0;var bK=aU.array.sum(bo.fieldOptions,function(bL){return bL.hidden?0:1});bI.menu("setIcon",{target:this,iconCls:bK>=bJ?"tree-checkbox1":(bK==0?"tree-checkbox0":"tree-checkbox2")})})}},"-"]};var bw={text:"过滤/显示",iconCls:"icon-standard-application-view-list",disabled:!bu.filterable,children:[]};var bt={text:"导出当前页",iconCls:"icon-standard-page-white-put",disabled:!(bn==true||bn.current==true),handler:function(){return bB.treegrid("exportExcel",false)}};var bs={text:"导出全部",iconCls:"icon-standard-page-white-stack",disabled:!(bn==true||bn.all==true),handler:function(){return bB.treegrid("exportExcel",true)}};aU.util.merge(bx.children,c(bB,bl,bo,br,bv,by));if(bu.filterable){aU.util.merge(bw.children,d(bB,bl,bo,br,bv,by))}aU.util.merge(bm,[bA,bz,"-",bx,bw]);var bp=[bt,bs];if(bn){aU.array.merge(bm,"-",typeof bn=="object"&&!bn.submenu?bp:{text:"导出数据",iconCls:"icon-standard-page-save",children:bp})}return bm}function c(bm,bo,bl,bq,bp,bn){return aU.array.map(bl.fieldOptions,function(bs){var br=function(by,bz,bA,bC,bB,bt){if(bs.field==bo.treeField){aU.messager.show("树节点列不能被隐藏。");return}var bu=aU(this),bx=bu.parent().find(".menu-item:gt(1) .tree-checkbox1").length;if((bx==1&&!bs.hidden)||!bs.hidable){return}bC.treegrid(bs.hidden?"showColumn":"hideColumn",bs.field);bt.menu("setIcon",{target:this,iconCls:bs.hidden?"tree-checkbox0":"tree-checkbox1"});bx=aU.array.sum(bl.fieldOptions,function(bD){return bD.hidden?0:1});var bw=bl.fields?bl.fields.length:0;bt.menu("setIcon",{target:bu.parent().children("div.menu-item:first"),iconCls:bx>=bw?"tree-checkbox1":(bx==0?"tree-checkbox0":"tree-checkbox2")});var bv=bu.parent().find(".menu-item:gt(1)").filter(function(){return aU(".tree-checkbox1",this).length?true:false});bv.each(function(){bt.menu(bv.length>1?"enableItem":"disableItem",this)})};return{text:bs.title||bs.field,iconCls:bs.hidden?"tree-checkbox0":"tree-checkbox1",hideOnClick:false,disabled:!bs.hidable||bs.field==bo.treeField?true:false,handler:br}})}function d(by,bl,bo,bq,bu,bw){var bz=by.treegrid("getRows"),bv=by.treegrid("getDistinctColumnData",bu),bn=[{text:"全部",hideOnClick:false,iconCls:(!bo.filterData||!bo.filterData.length)?"tree-checkbox1":(bo.filterData.length>=bz.length?"tree-checkbox0":"tree-checkbox2"),handler:function(bE,bD,bC,bA,bB,bF){if(bo.filterData&&bo.filterData.length){bA.treegrid("showRows",true)}else{bA.treegrid("hideRows",true)}aU(this).parent().children("div.menu-item[hideOnClick=false]").each(function(){bF.menu("setIcon",{target:this,iconCls:bo.filterData&&bo.filterData.length?"tree-checkbox0":"tree-checkbox1"})})}},"-"];var bm=bv.length>=15,bp=bm?aU.array.left(bv,10):bv,br=aU.array.map(bp,function(bF){var bE=aU.array.filter(bz,function(bH){return bH[bu]==bF}),bG=bE.length,bD=by.treegrid("getHiddenRows"),bA=aU.array.sum(bD,function(bH){return bH[bu]==bF?1:0}),bB=!bA?"tree-checkbox1":(bA>=bG?"tree-checkbox0":"tree-checkbox2");var bC=function(bN,bM,bK,bI,bJ,bO){var bL=bI.treegrid("getHiddenRows"),bH=aU.array.sum(bL,function(bP){return bP[bM]==bF?1:0});bI.treegrid(bH?"showRows":"hideRows",aU.array.map(bE,function(bP){return bP[bl.idField]}));bO.menu("setIcon",{target:this,iconCls:bH?"tree-checkbox1":"tree-checkbox0"});aU(this).parent().children("div.menu-item:first").each(function(){var bP=bI.treegrid("getHiddenRows");bO.menu("setIcon",{target:this,iconCls:(!bo.filterData.length)?"tree-checkbox1":(bP.length>=bz.length?"tree-checkbox0":"tree-checkbox2")})})};return{text:bF,iconCls:bB,hideOnClick:false,handler:bC}});aU.array.merge(bn,br);if(bm){var bs=by.treegrid("getColumnOption",bu),bt=bs.title?bs.title:bs.field,bx=function(){var bB=aU('<input type="button" value="全部选择" />').click(function(){by.treegrid("showRows",true);aU(this).parent().find(":checkbox").each(function(){this.checked=true})});var bA=aU('<input type="button" value="全部不选" />').click(function(){by.treegrid("hideRows",true);aU(this).parent().find(":checkbox").each(function(){this.checked=false})});aU("<div></div>").append("<div>列："+bt+"，共"+bv.length+"项</div><hr />").css({padding:"10px"}).append(bB).append(bA).append("<hr />").each(function(){var bD=aU(this),bC=aU("<ul></ul>").css({"list-style-type":"decimal","padding-left":"40px","line-height":"18px"}).appendTo(bD);aU.each(bv,function(bF,bK){var bL="itemCheckbox_"+aU.util.guid("N"),bI=!aU.array.some(bo.filterData,function(bM){return bM[bu]==bK}),bJ=aU("<li></li>").appendTo(bC),bH=aU("<input />").attr({type:"checkbox",id:bL,checked:bI}).appendTo(bJ),bE=aU("<label></label>").attr("for",bL).text(bK).appendTo(bJ),bG=function(){var bN=aU.array.filter(bz,function(bO){return bO[bu]==bK}),bM=aU.array.sum(bo.filterData,function(bO){return bO[bu]==bK?1:0});by.treegrid(bM?"showRows":"hideRows",aU.array.map(bN,function(bO){return bO[bl.idField]}))};bH.click(bG)})}).dialog({title:"过滤/显示",iconCls:"icon-standard-application-view-detail",height:260,width:220,left:bq.pageX,top:bq.pageY,collapsible:false,minimizable:false,maximizable:false,closable:true,modal:true,resizable:true,onClose:function(){aU(this).dialog("destroy")}}).dialog("open")};aU.array.merge(bn,["-",{text:"处理更多(共"+bv.length+"项)...",iconCls:"icon-standard-application-view-detail",handler:bx}])}return bn}function bj(bu,bv,bs,bC,bq,bo){var bA=[],bp=bv.pagingMenu,bz=bv.toggleMenu,by=bv.moveMenu,br=bv.exportMenu,bw=bq[bv.idField];if(typeof bp=="object"){bp=aU.extend({disabled:false,submenu:true},bp)}if(typeof bz=="object"){bz=aU.extend({expand:true,expandAll:true,collapse:true,collapseAll:true,submenu:false},bz)}if(typeof by=="object"){by=aU.extend({up:false,upLevel:false,down:false,downLevel:false,submenu:false},by)}if(typeof br=="object"){br=aU.extend({current:false,all:false,submenu:true},br)}var bn={text:"刷新当前页",iconCls:"pagination-load",disabled:!bv.refreshMenu,handler:function(){bu.treegrid("reload")}};var bm={text:"首页",iconCls:"pagination-first",disabled:function(){return !bv.pagination||bo.page<=1},handler:function(){if(bo.page>1){bo.pager.pagination("select",1)}}};var bl={text:"上一页",iconCls:"pagination-prev",disabled:function(){return !bv.pagination||bo.page<=1},handler:function(){if(bo.page>1){bo.pager.pagination("select",bo.page-1)}}};var bP={text:"下一页",iconCls:"pagination-next",disabled:function(){return !bv.pagination||bo.page>=bo.pageCount},handler:function(){if(bo.page<bo.pageCount){bo.pager.pagination("select",bo.page+1)}}};var bO={text:"末页",iconCls:"pagination-last",disabled:function(){return !bv.pagination||bo.page>=bo.pageCount},handler:function(){if(bo.page<bo.pageCount){bo.pager.pagination("select",bo.pageCount)}}};var bM={text:"展开当前所有",iconCls:"icon-metro-expand",disabled:!(bz==true||bz.expandAll==true),handler:function(){bu.treegrid("expandAll",bw)}};var bK={text:"展开当前",iconCls:"icon-metro-expand2",disabled:!(bz==true||bz.expand==true),handler:function(){bu.treegrid("expand",bw)}};var bI={text:"折叠当前",iconCls:"icon-metro-contract2",disabled:!(bz==true||bz.collapse==true),handler:function(){bu.treegrid("collapse",bw)}};var bF={text:"折叠当前所有",iconCls:"icon-metro-contract",disabled:!(bz==true||bz.collapseAll==true),handler:function(){bu.treegrid("collapseAll",bw)}};var bL={text:"上移一级",iconCls:"icon-standard-arrow-up",disabled:!(by==true||by.upLevel==true),handler:function(){bu.treegrid("shiftRow",{point:"upLevel",id:bw})}};var bJ={text:"上移",iconCls:"icon-standard-up",disabled:!(by==true||by.up==true),handler:function(){bu.treegrid("shiftRow",{point:"up",id:bw})}};var bH={text:"下移",iconCls:"icon-standard-down",disabled:!(by==true||by.down==true),handler:function(){bu.treegrid("shiftRow",{point:"down",id:bw})}};var bE={text:"下移一级",iconCls:"icon-standard-arrow-down",disabled:!(by==true||by.downLevel==true),handler:function(){bu.treegrid("shiftRow",{point:"downLevel",id:bw})}};var bD={text:"导出当前页",iconCls:"icon-standard-page-white-put",disabled:!(br==true||br.current==true),handler:function(){return bu.treegrid("exportExcel",false)}};var bB={text:"导出全部",iconCls:"icon-standard-page-white-stack",disabled:!(br==true||br.all==true),handler:function(){return bu.treegrid("exportExcel",true)}};bA.push(bn);var bN=[bm,bl,bP,bO],bt=[bM,bK,bI,bF],bG=[bL,bJ,bH,bE],bx=[bD,bB];if(bu.treegrid("isRoot",bw)){aU.array.insertRange(bt,0,[{text:"展开所有",iconCls:"icon-standard-arrow-out",handler:function(){bu.treegrid("expandAll")}},{text:"折叠所有",iconCls:"icon-standard-arrow-in",handler:function(){bu.treegrid("collapseAll")}},"-"])}if(bp){aU.array.merge(bA,"-",typeof bp=="object"&&!bp.submenu?bN:{text:"翻页",iconCls:"",disabled:!(bp==true||!bp.disabled),children:bN})}if(bz){aU.array.merge(bA,"-",typeof bz=="object"&&!bz.submenu?bt:{text:"展开/折叠",iconCls:"",disabled:!bz,children:bt})}if(by){aU.array.merge(bA,"-",typeof by=="object"&&!by.submenu?bG:{text:"上/下移动",iconCls:"",disabled:!by,children:bG})}if(br){aU.array.merge(bA,"-",typeof br=="object"&&!br.submenu?bx:{text:"导出数据",iconCls:"icon-standard-page-save",disabled:!br,children:bx})}return bA}var D=aU.fn.treegrid.extensions.parseRowContextMenuMap=function(bo,bp,bn,bm,bl){return aU.array.map(bm,function(bs,br){if(!bs||aU.util.isString(bs)){return bs}var bq=aU.extend({},bs);bq.id=aU.isFunction(bs.id)?bs.id.call(bq,bo,bp,bn,bl):bs.id;bq.text=aU.isFunction(bs.text)?bs.text.call(bq,bo,bp,bn,bl):bs.text;bq.iconCls=aU.isFunction(bs.iconCls)?bs.iconCls.call(bq,bo,bp,bn,bl):bs.iconCls;bq.disabled=aU.isFunction(bs.disabled)?bs.disabled.call(bq,bo,bp,bn,bl):bs.disabled;bq.hideOnClick=aU.isFunction(bs.hideOnClick)?bs.hideOnClick.call(bq,bo,bp,bn,bl):bs.hideOnClick;bq.onclick=aU.isFunction(bs.onclick)?function(bu,bt,bv){bs.onclick.call(this,bu,bp,bn,bl,bt,bv)}:bs.onclick;bq.handler=aU.isFunction(bs.handler)?function(bu,bt,bv){bs.handler.call(this,bu,bp,bn,bl,bt,bv)}:bs.handler;if(bq.children&&bq.children.length){bq.children=D(bo,bp,bn,bq.children,bl)}return bq})};function q(bm,bn,bl){bl.onDblClickRowBak=bn.onDblClickRow;bn.onDblClickRow=function(br){if(aU.isFunction(bl.onDblClickRowBak)){bl.onDblClickRowBak.apply(this,arguments)}var bq=aU.fn.datagrid.extensions.parseContextMenuEventData(bm,bn,null);items=a3(bm,bn,bl,null,br,bq);if(bn.autoBindDblClickRow&&bn.dblClickRowMenuIndex>=0&&aU.util.likeArray(bn.rowContextMenu)&&!aU.util.isString(bn.rowContextMenu)&&bn.rowContextMenu.length>bn.dblClickRowMenuIndex){var bp=items[bn.dblClickRowMenuIndex],bo=bp.handler||bp.onclick;if(!bp.disabled){return bo(null,br,bq,bm,bp,null)}}}}function at(bm,bn,bl){bl[bn.autoEditingEvent]=bn[bn.autoEditingEvent];bn[bn.autoEditingEvent]=function(bo){if(aU.isFunction(bl[bn.autoEditingEvent])){bl[bn.autoEditingEvent].apply(this,arguments)}if(bn.autoEditing){bm.treegrid("beginEdit",bo[bn.idField])}}}function a8(bm,bn,bl){aU(bn.finishEditLocale).click(function(bq){if(bn.finishEditOnBlur&&aU.data(bm[0],"treegrid")){var bo=bm.treegrid("getPanel"),bp=bm.treegrid("getEditingNodeIds");if(!aU.contains(bo[0],bq.target)){aU.each(bp,function(br,bs){bm.treegrid(bn.finishEditMethod,bs)})}}})}var aE=aU.fn.treegrid.extensions.initTreeGridExtensions=function(bm,bn,bl){bn=bn||bm.treegrid("options");bl=bl||(bn._extensionsTreegrid?bn._extensionsTreegrid:(bn._extensionsTreegrid={}));bl.onClickRowBak=bn.onClickRow;bn.onClickRow=function(bo){if(aU.isFunction(bl.onClickRowBak)){bl.onClickRowBak.apply(this,arguments)}if(bn.toggleOnClick){bm.treegrid("toggle",bo[bn.idField])}};bl.onCheckBak=bn.onCheck;bn.onCheck=function(bs){if(aU.isFunction(bl.onCheckBak)){bl.onCheckBak.apply(this,arguments)}if(bn.cascadeCheck){if(bn.checkOnSelect&&bn.singleSelect){return}var bo=bn.idField,bt=bs[bo],bp,br,bq=bm.treegrid("getParent",bt);while(bq){bp=bm.treegrid("getChildren",bq[bo]);br=bm.treegrid("getChecked");if(!aU.array.some(bp,function(bu){return !aU.array.contains(br,bu)})){if(!bm.treegrid("isChecked",bq[bo])){bm.treegrid("check",bq[bo])}}bq=bm.treegrid("getParent",bq[bo])}aU.each(bm.treegrid("getChildren",bt),function(bu,bv){if(!bm.treegrid("isChecked",bv[bo])){bm.treegrid("check",bv[bo])}})}};bl.onUncheckBak=bn.onUncheck;bn.onUncheck=function(bs){if(aU.isFunction(bl.onUncheckBak)){bl.onUncheckBak.apply(this,arguments)}if(bn.cascadeCheck){if(bn.checkOnSelect&&bn.singleSelect){return}var bo=bn.idField,bt=bs[bo],bp,br,bq=bm.treegrid("getParent",bt);while(bq){bp=bm.treegrid("getChildren",bq[bo]);br=bm.treegrid("getChecked");if(!aU.array.some(bp,function(bu){return aU.array.contains(br,bu)})){if(bm.treegrid("isChecked",bq[bo])){bm.treegrid("uncheck",bq[bo])}}bq=bm.treegrid("getParent",bq[bo])}aU.each(bm.treegrid("getChildren",bt),function(bu,bv){bm.treegrid("uncheck",bv[bo])})}}};var am=function(bl,bm){bl.treegrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").each(function(){var bn=aU(this),bp=bn.attr("node-id"),bo=bl.treegrid("find",bp);aC(bl,bm,bp,bo,bn)})};var aC=function(bm,bn,br,bp,bo){bo=bo||bm.treegrid("getRowDom",br);if(bn.rowTooltip){var bq=function(bt){var bs=aU(this),bu=aU.isFunction(bn.rowTooltip)?bn.rowTooltip.call(bs,bp):bl(bp);bs.tooltip("update",bu)};bo.each(function(){aU.easyui.tooltip.init(this,{onShow:bq})})}else{bo.children("td[field]").each(function(){var bw=aU(this),bu=bw.attr("field"),bt=bm.treegrid("getColumnOption",bu);if(!bt||!bt.tooltip){return}var bs=bw.find("div.datagrid-cell"),bv=function(by){var bx=aU(this),bz=aU.isFunction(bt.tooltip)?bt.tooltip.call(bs,bp[bu],br,bp):bp[bu];bx.tooltip("update",bz)};aU.easyui.tooltip.init(bs,{onShow:bv})})}function bl(bu){var bt=bm.treegrid("getColumns","all"),bs=aU("<table></table>").css({padding:"5px"});aU.each(bt,function(bv,bw){if(!bw||!bw.field||!bw.title){return}var bx=bm.treegrid("getCellDisplay",{field:bw.field,id:br});bs.append("<tr><td style='text-align: right; width: 150px;'>"+bw.title+":</td><td style='width: 250px;'>"+bx+"</td></tr>")});return bs}};var aK=function(bz,bl,bo){if(!bl.extEditing){return}var br=bz.treegrid("getRowDom",bo);if(!br.length){return}var bu=bz.treegrid("getPanel").find("div.datagrid-view"),bw=bu.find("div.datagrid-view1"),bv=bu.find("div.datagrid-view2"),bq=bv.find("div.datagrid-body"),bn=bw.outerWidth(),bt=bu.position(),bp=bx>0?bx:0;bq.css("position","relative");var by=br.outerHeight(),bs=br.position().top+by+bq.scrollTop()-bv.find("div.datagrid-header").outerHeight();var bm=aU("<div></div>").addClass("dialog-button datagrid-rowediting-panel").appendTo(bq).css({position:"absolute",display:"block",border:"1px solid #ddd",top:bs,padding:"5px 5px"}).attr("node-id",bo);aU("<a></a>").linkbutton({plain:false,iconCls:"icon-ok",text:"保存"}).appendTo(bm).click(function(){bz.treegrid("endEdit",bo);p(bz,bl,bo)});aU("<a></a>").linkbutton({plain:false,iconCls:"icon-cancel",text:"取消"}).appendTo(bm).click(function(){bz.treegrid("cancelEdit",bo);p(bz,bl,bo)});var bx=(bl.width-bm.outerWidth())/2-bn,bp=bx>0?bx:0;bm.css("left",bp)};var ai=function(bm,bl,bn){bl=bl||bm.treegrid("getPanel").find("div.datagrid-view div.datagrid-view2 div.datagrid-body");bl.find("div.datagrid-rowediting-panel[node-id="+bn+"]").remove()};var p=function(bl,bm,bn){if(!bm.extEditing){return}body=bl.treegrid("getPanel").find("div.datagrid-view div.datagrid-view2 div.datagrid-body");ai(bl,body,bn)};var N=function(bm,bn,bo){var bl=bn._extensionsTreegrid?bn._extensionsTreegrid:(bn._extensionsTreegrid={});if(bn.singleEditing){bm.treegrid("endEdit",bl.lastEditingId)}bl.lastEditingId=bo};var bd=aU.fn.treegrid.extensions.initExtensions=function(bu,bm){var bn=bm._extensionsTreegrid?bm._extensionsTreegrid:(bm._extensionsTreegrid={});if(bn._initialized){return}var bp=bu.treegrid("getColumnFields",false);bn.fields=aU.array.filter(bp,function(bx){return bu.treegrid("getColumnOption",bx).title?true:false});bn.fieldOptions=aU.array.map(bn.fields,function(bx){return bu.treegrid("getColumnOption",bx)});bn.fieldOptionsBackup=aU.array.map(bn.fieldOptions,function(bx){return aU.extend({},bx)});bn.filterData=[];br();bo();bt();bq();bl();bs();bw();function br(){aU.fn.datagrid.extensions.initColumnExtendProperties(bu,bn)}function bo(){bu.treegrid("setOffset",bm.offset)}function bt(){au(bu,bm,bn);ak(bu,bm,bn);aW(bu,bm,bn)}function bq(){q(bu,bm,bn)}function bl(){at(bu,bm,bn)}function bs(){a8(bu,bm,bn)}function bw(){aE(bu,bm,bn)}var bv=bu.datagrid("getRows");if(!bv||!bv.length){ao(bu,bm,bn)}bn._initialized=true};var J=aU.fn.treegrid.extensions.loader=function(bp,bo,bl){var bm=aU(this),bn=bm.treegrid("options");bd(bm,bn);if(!bn.url){return false}bp=aU.fn.datagrid.extensions.parsePagingQueryParams(bn,bp);aU.ajax({type:bn.method,url:bn.url,data:bp,dataType:"json",success:function(bq){bo(bq)},error:function(){bl.apply(this,arguments)}})};var v=aU.fn.treegrid.defaults.onLoadSuccess;var a7=aU.fn.treegrid.extensions.onLoadSuccess=function(bo){if(aU.isFunction(v)){v.apply(this,arguments)}var bm=aU(this),bn=bm.treegrid("options"),bl=bn._extensionsTreegrid?bn._extensionsTreegrid:(bn._extensionsTreegrid={});ao(bm,bn,bl);ah(bm,bn);am(bm,bn)};var C=aU.fn.treegrid.defaults.onResizeColumn;var az=aU.fn.treegrid.extensions.onResizeColumn=function(br,bo){if(aU.isFunction(C)){C.apply(this,arguments)}var bn=aU(this),bp=bn.treegrid("options");if(bp.columnFilter){var bm=bn.treegrid("getPanel"),bq=bn.treegrid("getColumnOption",br),bl=bm.find("div.datagrid-header-filter-container[field="+br+"]");bl.width(bq.width)}};var m=aU.fn.treegrid.defaults.onBeforeEdit;var aS=aU.fn.treegrid.extensions.onBeforeEdit=function(bn){if(aU.isFunction(m)){m.apply(this,arguments)}var bl=aU(this),bm=bl.datagrid("options");aK(bl,bm,bn[bm.idField]);N(bl,bm,bn[bm.idField]);bl.treegrid("getPanel").find("div.datagrid-view div.datagrid-body table.datagrid-btable tr.datagrid-row").draggable("disable")};var I=aU.fn.treegrid.defaults.onAfterEdit;var ax=aU.fn.treegrid.extensions.onAfterEdit=function(bp,bn){if(aU.isFunction(I)){I.apply(this,arguments)}var bm=aU(this),bo=bm.treegrid("options"),bl=bo._extensionsTreegrid?bo._extensionsTreegrid:(bo._extensionsTreegrid={});p(bm,bo,bp[bo.idField]);ao(bm,bo,bl);ah(bm,bo);aC(bm,bo,bp[bo.idField],bp)};var y=aU.fn.treegrid.defaults.onCancelEdit;var ba=aU.fn.treegrid.extensions.onCancelEdit=function(bn){if(aU.isFunction(y)){y.apply(this,arguments)}var bl=aU(this),bm=bl.treegrid("options");p(bl,bm,bn[bm.idField]);ah(bl,bm);aC(bl,bm,bn[bm.idField],bn)};var Q=aU.fn.treegrid.defaults.loadFilter;var a5=aU.fn.treegrid.extensions.loadFilter=function(bq,bn){if(aU.isFunction(Q)){bq=Q.apply(this,arguments)}var bl=aU.array.likeArray(bq)&&!aU.util.isString(bq),bp=bl?bq:bq.rows;if(!bp.length){return bq}var bm=aU(this),bo=bm.treegrid("options");bp=bo.dataPlain?aU.fn.tree.extensions.dataPlainConverter(bp,bo):bp;if(bn!=null&&bn!=x){return bl?bp:{total:bp.length,rows:bp}}return bl?bp:{total:bq.length||bp.length,rows:bp}};var P=aU.fn.treegrid.defaults.onExpand;var aY=aU.fn.treegrid.extensions.onExpand=function(bp){if(aU.isFunction(P)){P.apply(this,arguments)}var bm=aU(this),bn=bm.treegrid("options");if(bn.onlyNodeExpand){var bo=bm.treegrid("getNears",bp[bn.idField]),bl=bn.animate;bn.animate=false;aU.each(aU.array.filter(bo,function(bq){return bq[bn.idField]!=bp[bn.idField]&&bq.state=="open"}),function(){bm.treegrid("collapse",this[bn.idField])});bn.animate=bl}};var aV=aU.fn.treegrid.extensions.methods={update:function(bm,bl){return bm.each(function(){a4(this,bl)})},append:function(bm,bl){return bm.each(function(){w(this,bl)})},insert:function(bm,bl){return bm.each(function(){t(this,bl)})},isChecked:function(bm,bl){return R(bm[0],bl)},isSelected:function(bm,bl){return a9(bm[0],bl)},isEditing:function(bm,bl){return aO(bm[0],bl)},getEditingNodeId:function(bl){return aH(bl[0])},getEditingNodeIds:function(bl){return aA(bl[0])},isRoot:function(bm,bl){return r(bm[0],bl)},getLevel:function(bm,bl){return aX(bm[0],bl)},freezeColumn:function(bm,bl){return bm.each(function(){ac(this,bl)})},unfreezeColumn:function(bm,bl){return bm.each(function(){F(this,bl)})},moveColumn:function(bm,bl){return bm.each(function(){l(this,bl)})},shiftColumn:function(bm,bl){return bm.each(function(){bc(this,bl)})},deleteColumn:function(bm,bl){return bm.each(function(){aR(this,bl)})},popColumn:function(bm,bl){return aF(bm[0],param)},moveRow:function(bm,bl){return bm.each(function(){e(this,bl)})},shiftRow:function(bm,bl){return bm.each(function(){o(this,bl)})},compare:function(bm,bl){return V(bm[0],bl)},isChild:function(bm,bl){return bk(bm[0],bl)},isParent:function(bm,bl){return g(bm[0],bl)},isSibling:function(bm,bl){return s(bm[0],bl)},nextRow:function(bm,bl){return bg(bm[0],bl)},prevRow:function(bm,bl){return E(bm[0],bl)},getNears:function(bm,bl){return bh(bm[0],bl)},getNearChildren:function(bm,bl){return aT(bm[0],bl)},enableRowDnd:function(bl){return bl.each(function(){aw(this)})},disableRowDnd:function(bl){return bl.each(function(){bi(this)})},getRows:function(bm,bl){return G(bm[0],bl)},getColumnData:function(bm,bl){return z(bm[0],bl)},getRowDom:function(bm,bl){return bf(bm[0],bl)},getRowData:function(bm,bl){return M(bm[0],bl)},getNode:function(bm,bl){return M(bm[0],bl)},getNodes:function(bm,bl){return a6(bm[0],bl)},getCellDom:function(bm,bl){return aj(bm[0],bl)},getCellData:function(bm,bl){return ap(bm[0],bl)},getCellDisplay:function(bm,bl){return bb(bm[0],bl)},getDistinctRows:function(bm,bl){return K(bm[0],bl)},getDistinctColumnData:function(bm,bl){return a0(bm[0],bl)},showRow:function(bm,bl){return bm.each(function(){aJ(this,bl)})},hideRow:function(bm,bl){return bm.each(function(){S(this,bl)})},showRows:function(bm,bl){return bm.each(function(){aQ(this,bl)})},hideRows:function(bm,bl){return bm.each(function(){f(this,bl)})},getHiddenRows:function(bm,bl){return ae(bm[0],bl)},getVisibleRows:function(bm,bl){return aN(bm[0],bl)},livesearch:function(bm,bl){return bm.each(function(){aB(this,bl)})},find:function(bm,bl){return aZ(bm[0],bl)},findRow:function(bm,bl){return aZ(bm[0],bl)},findRows:function(bm,bl){return a6(bm[0],bl)},remove:function(bm,bl){return bm.each(function(){av(this,bl)})},deleteRow:function(bm,bl){return bm.each(function(){k(this,bl)})},deleteRows:function(bm,bl){return bm.each(function(){Y(this,bl)})},setColumnTitle:function(bm,bl){return bm.each(function(){aa(this,bl)})},select:function(bm,bl){return bm.each(function(){ay(this,bl)})},unselect:function(bm,bl){return bm.each(function(){b(this,bl)})},selectRow:function(bm,bl){return bm.each(function(){ay(this,bl)})},unselectRow:function(bm,bl){return bm.each(function(){b(this,bl)})},check:function(bm,bl){return bm.each(function(){L(this,bl)})},uncheck:function(bm,bl){return bm.each(function(){aL(this,bl)})},checkRow:function(bm,bl){return bm.each(function(){L(this,bl)})},uncheckRow:function(bm,bl){return bm.each(function(){aL(this,bl)})},setColumnFilter:function(bm,bl){return bm.each(function(){A(this,bl)})},columnFilterSelect:function(bm,bl){return bm.each(function(){u(this,bl)})},setOffset:function(bm,bl){return bm.each(function(){ad(this,bl)})},exportExcel:function(bm,bl){return bm.each(function(){aG(this,bl)})}};var af=aU.fn.treegrid.extensions.defaults={offset:null,dataPlain:false,parentField:"pid",toggleOnClick:false,onlyNodeExpand:false,cascadeCheck:false,loadFilter:a5,onExpand:aY,autoBindDblClickRow:true,dblClickRowMenuIndex:0,exportMenu:false,selectOnRowContextMenu:false,hideDisabledMenu:false,headerContextMenu:null,rowContextMenu:null,enableHeaderClickMenu:true,enableHeaderContextMenu:true,enableRowContextMenu:true,toggleMenu:true,moveMenu:false,pagingMenu:false,refreshMenu:true,dndRow:false,rowTooltip:false,extEditing:true,autoEditing:false,autoEditingEvent:"onDblClickRow",finishEditOnBlur:true,finishEditLocale:window.document,finishEditMethod:"endEdit",singleEditing:true,columnFilter:null,showFilterText:x,loader:J,onLoadSuccess:a7,onResizeColumn:az,onBeforeEdit:aS,onAfterEdit:ax,onCancelEdit:ba,onBeforeDeleteColumn:function(bl){},onDeleteColumn:function(bl){},onBeforeMoveColumn:function(bm,bn,bl){},onMoveColumn:function(bm,bn,bl){},onBeforeDrop:function(bn,bm,bl){},onDrop:function(bn,bm,bl){},onBeforeDrag:function(bl){},onStartDrag:function(bl){},onStopDrag:function(bl){},onDragEnter:function(bm,bl){},onDragOver:function(bm,bl){},onDragLeave:function(bm,bl){},onBeforeUpdate:function(bl,bm){},onUpdate:function(bl,bm){},onBeforeAppend:function(bl,bm){},onAppend:function(bl,bm){},onBeforeInsert:function(bl,bn,bm){},onInsert:function(bm,bn,bl){},onBeforeRemove:function(bl){},onRemove:function(bl){}};aU.extend(aU.fn.treegrid.defaults,af);aU.extend(aU.fn.treegrid.methods,aV);var aP={onBeforeRender:function(bq,br,bp){if(aU.isArray(br)){bp={total:br.length,rows:br};br=null}if(!bp){return false}var bo=aU.data(bq,"treegrid");var bn=bo.options;if(bp.length==x){if(bp.footer){bo.footer=bp.footer}if(bp.total){bo.total=bp.total}bp=this.transfer(bq,br,bp.rows)}bl(bp.length==x?bp.rows:bp,br);var bm=aZ(bq,br);if(bm){if(bm.children){bm.children=bm.children.concat(bp)}else{bm.children=bp}}else{bo.data=bo.data.concat(bp)}if(!bn.remoteSort){this.sort(bq,bp)}this.treeNodes=bp;this.treeLevel=aU(bq).treegrid("getLevel",br);function bl(bt,bv){for(var bs=0;bs<bt.length;bs++){var bu=bt[bs];bu._parentId=bv;if(bu.children&&bu.children.length){bl(bu.children,bu[bn.idField])}}}}};aU.extend(aU.fn.treegrid.defaults.view,aP)})(jQuery);