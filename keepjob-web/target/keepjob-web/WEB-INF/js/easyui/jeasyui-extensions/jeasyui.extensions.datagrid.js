(function(aX,B){aX.fn.datagrid.extensions={};var w=aX.fn.datagrid.methods.updateRow;var X=aX.fn.datagrid.methods.appendRow;var N=aX.fn.datagrid.methods.insertRow;var a6=function(bp,bq){if(!bq||!bq.row||!aX.isNumeric(bq.index)){return}var bn=aX(bp),bo=bn.datagrid("options");if(aX.isFunction(bo.onBeforeUpdateRow)&&bo.onBeforeUpdateRow.call(bp,bq.index,bq.row)==false){return}w.call(bn,bn,bq);at(bn,bo);ai(bn,bo);aE(bn,bo,bq.index,bq.row);if(aX.isFunction(bo.onUpdateRow)){bo.onUpdateRow.call(bp,bq.index,bq.row)}};var z=function(br,bs){if(!bs){return}var bo=aX(br),bp=bo.datagrid("options");if(aX.isFunction(bp.onBeforeAppendRow)&&bp.onBeforeAppendRow.call(br,bs)==false){return}X.call(bo,bo,bs);var bq=bo.datagrid("getRows"),bn=bq.length-1;at(bo,bp);ai(bo,bp);aE(bo,bp,bn,bs);if(aX.isFunction(bp.onAppendRow)){bp.onAppendRow.call(br,bs)}};var s=function(bp,bq){if(!bq||!bq.row||!aX.isNumeric(bq.index)){return}var bn=aX(bp),bo=bn.datagrid("options");if(aX.isFunction(bo.onBeforeInsertRow)&&bo.onBeforeInsertRow.call(bp,bq.index,bq.row)==false){return}N.call(bn,bn,bq);at(bn,bo);ai(bn,bo);aE(bn,bo,bq.index,bq.row);if(aX.isFunction(bo.onInsertRow)){bo.onInsertRow.call(bp,bq.index,bq.row)}};var az=aX.fn.datagrid.methods.beginEdit;var R=function(bt,bo){var bp=aX(bt),bs=bp.datagrid("options"),bn=az.call(bp,bp,bo);if(bs.autoFocusField){var br=bp.datagrid("getEditors",bo);if(br.length){var bq=aX.array.first(br,function(bu){return bu.field==bs.autoFocusField});if(!bq){bq=br[0]}if(bq){aX.util.exec(function(){if(bq.actions&&aX.isFunction(bq.actions.setFocus)){bq.actions.setFocus(bq.target[0])}else{bq.target.focus()}})}}}return bn};var V=function(br,bn){var bo=aX(br),bq=bo.datagrid("getChecked"),bp=aX.array.map(bq,function(bs){return bo.datagrid("getRowIndex",bs)});return aX.array.contains(bp,bn)};var bd=function(br,bn){var bo=aX(br),bq=bo.datagrid("getSelections"),bp=aX.array.map(bq,function(bs){return bo.datagrid("getRowIndex",bs)});return aX.array.contains(bp,bn)};var aQ=function(bq,bo){var bp=aX(bq),bn=bp.datagrid("getPanel");return bn.find("div.datagrid-view div.datagrid-body table tr.datagrid-row[datagrid-row-index="+bo+"]").hasClass("datagrid-row-editing")};var y=function(bn){var bo=aH(bn);return bo.length?bo[0]:-1};var aH=function(bq){var bo=aX(bq),bn=bo.datagrid("getPanel"),bp=bn.find("div.datagrid-view div.datagrid-body table tr.datagrid-row.datagrid-row-editing").map(function(){return window.parseInt(aX(this).attr("datagrid-row-index"))}),br=aX.array.distinct(aX.array.clone(bp));return br};var ae=function(br,bq){var bp=aX(br),bo=bp.datagrid("getColumnFields"),bn=bp.datagrid("getColumnFields",true);if(!bn||!bn.length||!aX.array.contains(bo,bq)||aX.array.contains(bn,bq)){return}bp.datagrid("moveColumn",{source:bq,target:bn[bn.length-1],point:"after"})};var L=function(br,bq){var bp=aX(br),bo=bp.datagrid("getColumnFields"),bn=bp.datagrid("getColumnFields",true);if(!bo||!bo.length||aX.array.contains(bo,bq)||!aX.array.contains(bn,bq)){return}bp.datagrid("moveColumn",{source:bq,target:bo[0],point:"before"})};var f=function(bs,bp){if(!bp||!aX.isNumeric(bp.source)||!aX.isNumeric(bp.target)||bp.source==bp.target||!bp.point){return}if(!aX.array.contains(["top","bottom"],bp.point)){bp.point="top"}var bt=aX(bs),bn=bt.datagrid("options"),bv=bt.datagrid("getRows"),bq=bv[bp.source],bo=bv[bp.target];if(!bq||!bo){return}if(aX.isFunction(bn.onBeforeDrop)&&bn.onBeforeDrop.call(bs,bo,bq,bp.point)==false){return}var bu=bt.datagrid("popRow",bp.source),br=bt.datagrid("getRowIndex",bo);bv=bt.datagrid("getRows");switch(bp.point){case"top":bt.datagrid("insertRow",{index:br,row:bu});break;case"bottom":if(br++>=bv.length){bt.datagrid("appendRow",bu)}else{bt.datagrid("insertRow",{index:br,row:bu})}break;default:break}if(bu&&aX.isFunction(bn.onDrop)){bn.onDrop.call(bs,bo,bq,bp.point)}};var p=function(br,bs){if(!bs||!aX.isNumeric(bs.index)||!bs.point||!aX.array.contains(["up","down"],bs.point)){return}var bp=aX(br),bq=bp.datagrid("options"),bo=bs.point=="up"?bs.index-1:bs.index+1,bn=bs.point=="up"?"top":"bottom";bp.datagrid("moveRow",{source:bs.index,target:bo,point:bn})};var bk=function(br,bn){var bp=aX(br),bq=bp.datagrid("getRows"),bo=bn+1;return bq[bo]?bq[bo]:null};var K=function(br,bn){var bp=aX(br),bq=bp.datagrid("getRows"),bo=bn-1;return bq[bo]?bq[bo]:null};var J=function(bq,bn){var bo=aX(bq),bp=bo.datagrid("getRows"),br=bp[bn];if(!br){return null}bo.datagrid("deleteRow",bn);return br};var aA=function(bq){var bn=aX(bq),bp=bn.datagrid("options");bn.datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable({disabled:false,revert:true,cursor:"default",deltaX:10,deltaY:5,proxy:function(bu){var bt=aX(bu),bs=parseInt(bt.attr("datagrid-row-index")),bv=bn.datagrid("getRowDom",bs).clone(),br=aX("<tr></tr>").addClass("datagrid-row datagrid-row-selected");aX("<td><span class='tree-dnd-icon tree-dnd-no' ></span></td>").appendTo(br);var bw=bv.find("td").each(function(bx){if(bx<6){br.append(this)}});if(bw.length>6){aX("<td>...</td>").css("width","40px").appendTo(br)}return aX("<table></table>").addClass("tree-node-proxy").appendTo("body").append(br).hide()},onBeforeDrag:function(bt){var bs=aX(this),br=parseInt(bs.attr("datagrid-row-index")),bu=bn.datagrid("getRowData",br);if(aX.isFunction(bp.onBeforeDrag)&&bp.onBeforeDrag.call(bq,br,bu)==false){return false}if(bt.which!=1){return false}if(bt.target.type=="checkbox"){return false}},onStartDrag:function(){var bs=aX(this),br=parseInt(bs.attr("datagrid-row-index")),bt=bn.datagrid("getRowData",br);bs.draggable("proxy").css({left:-10000,top:-10000});if(aX.isFunction(bp.onBeforeDrag)){bp.onStartDrag.call(bq,br,bt)}},onStopDrag:function(){var bs=aX(this),br=parseInt(bs.attr("datagrid-row-index")),bt=bn.datagrid("getRowData",br);if(aX.isFunction(bp.onStopDrag)){bp.onStopDrag.call(bq,br,bt)}},onDrag:function(bv){var bs=bv.pageX,bu=bv.pageY,br=bv.data.startX,bt=bv.data.startY;var bw=Math.sqrt((bs-br)*(bs-br)+(bu-bt)*(bu-bt));if(bw>15){aX(this).draggable("proxy").show()}this.pageY=bv.pageY}}).droppable({accept:"tr.datagrid-row",onDragEnter:function(bz,br){var bs=aX(this),bB=aX(br),bA=parseInt(bs.attr("datagrid-row-index")),bw=parseInt(bB.attr("datagrid-row-index")),bC=bn.datagrid("getRowData",bA),by=bn.datagrid("getRowData",bw),bv=bn.datagrid("getRowDom",bA),bu=bv.find("td");var bt=bs.data("dnd"),bx={droper:bs,drager:bB,droperIndex:bA,dragerIndex:bw,droperRow:bC,dragerRow:by,droperRowDom:bv,mark:bu};if(!bt){bs.data("dnd",bx)}else{aX.extend(bt,bx)}if(aX.isFunction(bp.onDragEnter)&&bp.onDragEnter.call(bq,bC,by)==false){bo(bB,false);bu.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom");bs.droppable("disable")}},onDragOver:function(bx,br){var bs=aX(this),bt=bs.data("dnd"),bz=bt.drager,bA=bt.droperRow,bw=bt.dragerRow,bv=bt.mark;if(bs.droppable("options").disabled){return}var bu=br.pageY,by=bs.offset().top,bB=by+bs.outerHeight();bo(bz,true);bv.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom");if(bu>by+(bB-by)/2){bv.addClass("datagrid-header-cell-bottom")}else{bv.addClass("datagrid-header-cell-top")}if(bp.onDragOver.call(bq,bA,bw)==false){bo(bz,false);bv.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom");bs.droppable("disable")}},onDragLeave:function(bw,bv){var bs=aX(this),bu=bs.data("dnd"),bt=bu.drager,bx=bu.droperRow,br=bu.dragerRow,by=bu.mark;bo(bt,false);by.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom");if(aX.isFunction(bp.onDragLeave)){bp.onDragLeave.call(bq,bx,br)}},onDrop:function(bw,bv){var bs=aX(this),bt=bs.data("dnd"),bu=bt.droperIndex,bx=bt.dragerIndex,by=bt.mark,br=by.hasClass("datagrid-header-cell-top")?"top":"bottom";bn.datagrid("moveRow",{target:bu,source:bx,point:br});by.removeClass("datagrid-header-cell-top datagrid-header-cell-bottom")}});bp.dndRow=true;function bo(bt,bs){var br=bt.draggable("proxy").find("span.tree-dnd-icon");br.removeClass("tree-dnd-yes tree-dnd-no").addClass(bs?"tree-dnd-yes":"tree-dnd-no")}};var bl=function(bp){var bn=aX(bp),bo=bn.datagrid("options");bn.datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable("disable");bo.dndRow=false};var aY=function(br,bq){var bp=aX(br),bn=aX.array.merge([],bp.datagrid("getColumnFields",true),bp.datagrid("getColumnFields",false)),bo=aX.array.indexOf(bn,bq);if(bo==-1||bo+1>=bn.length){return null}return bp.datagrid("getColumnOption",bn[bo+1])};var aV=function(br,bq){var bp=aX(br),bn=aX.array.merge([],bp.datagrid("getColumnFields",true),bp.datagrid("getColumnFields",false)),bo=aX.array.indexOf(bn,bq);if(bo<1){return null}return bp.datagrid("getColumnOption",bn[bo-1])};var m=function(bO,bq){if(!bq||!bq.source||!bq.target||bq.source==bq.target||!bq.point){return}if(!aX.array.contains(["before","after"],bq.point)){bq.point="before"}var bA=aX(bO);if(bA.datagrid("hasMuliRowHeader")){return}var bB=bA.datagrid("options"),bu,bC,bD=bA.datagrid("getColumnFields"),bL=bA.datagrid("getColumnFields",true);if(aX.array.contains(bD,bq.source)){bu=false}if(bu==B&&aX.array.contains(bL,bq.source)){bu=true}if(aX.array.contains(bD,bq.target)){bC=false}if(bC==B&&aX.array.contains(bL,bq.target)){bC=true}if(bu==B||bC==B){return}if(aX.isFunction(bB.onBeforeMoveColumn)&&bB.onBeforeMoveColumn.call(bO,bq.source,bq.target,bq.point)==false){return}var bx=bA.datagrid("getPanel"),by=bx.find("div.datagrid-view"),bK=by.find("div.datagrid-view1"),bJ=by.find("div.datagrid-view2"),bs=bK.find("div.datagrid-header table tr.datagrid-header-row"),br=bJ.find("div.datagrid-header table tr.datagrid-header-row"),bI=bK.find("div.datagrid-body table tr.datagrid-row"),bH=bJ.find("div.datagrid-body table tr.datagrid-row"),bv=bu?bs.find("td[field="+bq.source+"]"):br.find("td[field="+bq.source+"]"),bN=bC?bs.find("td[field="+bq.target+"]"):br.find("td[field="+bq.target+"]"),bM=bu?bI:bH,bo=bC?bI:bH;if(bM.length!=bo.length){return}bN[bq.point](bv);bo.each(function(bQ,bS){var bR=aX(this).find("td[field="+bq.target+"]"),bP=aX(bM[bQ]).find("td[field="+bq.source+"]");bR[bq.point](bP)});var bG=bA.datagrid("getColumnOption",bq.source),bn=bA.datagrid("getColumnOption",bq.target),bF=bu?bB.frozenColumns[0]:bB.columns[0],bt=bC?bB.frozenColumns[0]:bB.columns[0],bw=bB._extensionsDatagrid?bB._extensionsDatagrid:(bB._extensionsDatagrid={});aX.array.remove(bF,bG);var bp=aX.array.indexOf(bt,bn);if(bp>-1){aX.array.insert(bt,bq.point=="before"?bp:bp+1,bG)}bA.datagrid("fixColumnSize");if(bu){if(!bC){bp=aX.array.indexOf(bw.fields,bq.target);aX.array.insert(bw.fields,bq.point=="before"?bp:bp+1,bq.source);aX.array.insert(bw.fieldOptions,bq.point=="before"?bp:bp+1,bG);aX.array.insert(bw.fieldOptionsBackup,bq.point=="before"?bp:bp+1,aX.extend({},bG))}}if(!bu){bp=aX.array.indexOf(bw.fields,bq.source);if(bC){aX.array.removeAt(bw.fields,bp);aX.array.removeAt(bw.fieldOptions,bp);aX.array.removeAt(bw.fieldOptionsBackup,bp)}else{var bE=bw.fieldOptions[bp],bz=bw.fieldOptionsBackup[bp];aX.array.removeAt(bw.fields,bp);aX.array.removeAt(bw.fieldOptions,bp);aX.array.removeAt(bw.fieldOptionsBackup,bp);bp=aX.array.indexOf(bw.fields,bq.target);aX.array.insert(bw.fields,bq.point=="before"?bp:bp+1,bq.source);aX.array.insert(bw.fieldOptions,bq.point=="before"?bp:bp+1,bE);aX.array.insert(bw.fieldOptionsBackup,bq.point=="before"?bp:bp+1,bz)}}if(aX.isFunction(bB.onMoveColumn)){bB.onMoveColumn.call(bO,bq.source,bq.target,bq.point)}};var bh=function(bq,br){if(!br||!br.field||!br.point){return}if(!aX.array.contains(["before","after"],br.point)){br.point="before"}var bp=aX(bq),bn=bp.datagrid("getColumnFields","all"),bo=aX.array.indexOf(bn,br.field);if(bo==-1||(br.point=="before"&&bo==0)||(br.point=="after"&&bo==bn.length-1)){return}var bq=bn[br.point=="before"?bo-1:bo+1];bp.datagrid("moveColumn",{source:br.field,target:bq,point:br.point})};var aU=function(br,bq){var bo=aX(br),bp=bo.datagrid("options"),bn=bp._extensionsDatagrid?bp._extensionsDatagrid:(bp._extensionsDatagrid={});if(aX.isFunction(bp.onBeforeDeleteColumn)&&bp.onBeforeDeleteColumn.call(br,bq)==false){return}W(bp,bq,bn);bo.datagrid("getColumnDom",{field:bq,header:true}).remove();if(aX.isFunction(bp.onDeleteColumn)){bp.onDeleteColumn.call(br,bq)}};var aI=function(bq,bp){var bn=aX(bq),bo=bn.datagrid("getColumnOption",bp);if(bo){bn.datagrid("deleteColumn",bp)}return bo};var W=aX.fn.datagrid.extensions.removeField=function(br,bt,bq){var bp,bs,bo=-1,bn=-1;if(aX.array.likeArray(br.frozenColumns)){aX.each(br.frozenColumns,function(bv,bu){if(aX.array.likeArray(this)){aX.each(this,function(bx,bw){if(bw.field==bt){bn=bx;return false}})}else{if(bu.field==bt){bn=bv;return false}}if(bn>-1){bo=bv;return false}});if(bn>-1){bs=true}}if(bs==B&&aX.array.likeArray(br.columns)){aX.each(br.columns,function(bv,bu){if(aX.array.likeArray(this)){aX.each(this,function(bx,bw){if(bw.field==bt){bn=bx;return false}})}else{if(bu.field==bt){bn=bv;return false}}if(bn>-1){bo=bv;return false}});if(bn>-1){bs=false}}if(bn>-1){bp=(bs?br.frozenColumns:br.columns);bp=bo>-1?bp[bo]:bp;aX.array.removeAt(bp,bn);index=aX.array.indexOf(bq.fields,bt);aX.array.remove(bq.fields,bt);aX.array.removeAt(bq.fieldOptions,index);aX.array.removeAt(bq.fieldOptionsBackup,index)}};var ac=function(bp){var bn=aX(bp),bo=bn.datagrid("options");return(bo.columns&&bo.columns.length>1&&bo.columns[1].length>0)||(bo.frozenColumns&&bo.frozenColumns.length>1&&bo.frozenColumns[1].length>0)};var ba=function(bq,br){var bo=aX(bq),bp=bo.datagrid("getRows"),bn;if(aX.isFunction(br)){bn=aX.array.filter(bp,br)}else{if(aX.array.likeArray(br)&&!aX.util.isString(br)){bn=aX.array.map(br,function(bs){return a1(bq,bs,bo,bp)});bn=aX.array.filter(bn,function(bs){return bs!=B&&bs!=null})}else{bn=[a1(bq,br,bo,bp)]}}return bn};var a1=function(bs,bt,bo,br){var bn=bo||aX(bs),bq=br||bn.datagrid("getRows"),bp=bn.datagrid("options");return aX.array.first(bq,aX.isFunction(bt)?bt:function(bu){return bu[bp.idField]==bt})};var H=aX.fn.datagrid.methods.deleteRow;var l=function(bq,bo,br){var bt=aX(bq),bn=bt.datagrid("options"),bs=aX.isFunction(bo),bp,bv;if(br==B||br==null){br=true}if(bs){var bu=bt.datagrid("getRows");bv=aX.array.first(bu,bo);bp=bt.datagrid("getRowIndex",bv)}else{bp=bo;bv=bt.datagrid("getRowData",bp)}if(aX.isNumeric(bp)&&bp>-1&&aX.isFunction(bn.onBeforeDeleteRow)&&bn.onBeforeDeleteRow.call(bq,bp,bv)==false){return}H.call(bt,bt,bp);if(aX.isFunction(bn.onDeleteRow)){bn.onDeleteRow.call(bq,bp,bv)}if(br){at(bt,bn)}};var ab=function(br,bs){var bo=aX(br),bp=bo.datagrid("options"),bn=aX.array.likeArrayNoString(bs);if(bn=aX.array.likeArrayNoString(bs)){aX.each(bs,function(bt,bu){l(br,bu,false)})}else{var bo=aX(br),bq=bo.datagrid("getRows");aX.each(bq,function(bt,bv){if(bs.call(bv,bv,bt,bq)==true){var bu=bo.datagrid("getRowIndex",bv);H.call(bo,bo,bu)}})}at(bo,bp)};var ad=function(br,bt){if(bt&&bt.field&&bt.title){var bo=aX(br),bq=bo.datagrid("getColumnOption",bt.field),bp=bt.field,bs=bt.title,bn=bo.datagrid("getPanel"),bu=bn.find("div.datagrid-view div.datagrid-header tr.datagrid-header-row td[field="+bp+"]");if(bu.length){bu.find("div.datagrid-cell span:first").html(bs);bq.title=bs}}};var h=function(br,bq){if(bq&&bq.field&&bq.width&&aX.isNumeric(bq.width)){var bo=aX.data(br,"datagrid"),bw=aX(br),bn=bw.datagrid("options"),bs=bw.datagrid("getColumnOption",bq.field),bt=bq.field,bp=bq.width,bv=bw.datagrid("getPanel").find("div.datagrid-view div.datagrid-header tr.datagrid-header-row td[field="+bt+"] div.datagrid-cell");if(bv.length){var bu=bv._outerWidth()-parseInt(bv[0].style.width);bv.css("height","");bs.width=bp;bs.boxWidth=bp-bu;bs.auto=B;bv.width(bs.boxWidth);bw.datagrid("fixColumnSize",bt);bw.datagrid("fitColumns");bn.onResizeColumn.call(br,bt,bp)}}};aX.fn.datagrid.extensions.parseOffset=function(bo){var bn={enable:bo?true:false};if(bn.enable){aX.extend(bn,bo)}bn.width=aX.isNumeric(bn.width)?bn.width:0;bn.height=aX.isNumeric(bn.height)?bn.height:0;return bn};var af=function(bq,br){var bo=aX(bq),bp=bo.datagrid("options"),bn=bp._extensionsDatagrid?bp._extensionsDatagrid:(bp._extensionsDatagrid={});bp.offset=bn.offset=aX.fn.datagrid.extensions.parseOffset(br);if(bn.offset&&bn.offset.enable){if(!aX.isFunction(bn.offsetFunction)){bn.offsetFunction=function(){if(!bn.offset.enable){return}var bs=aX.util.windowSize();bo.datagrid("resize",{width:bs.width+bn.offset.width,height:bs.height+bn.offset.height})};aX(window).resize(bn.offsetFunction)}bn.offsetFunction()}};var aK=function(br,bt){if(aX.string.isNullOrEmpty(bt)){return aX()}var bp=aX(br),bo=bp.datagrid("getPanel"),bn=!aX.string.isString(bt),bq=bn?bt.field:bt,bu=bn?bt.header:false,bs=bo.find("div.datagrid-view tr.datagrid-row td[field="+bq+"]");if(bu){bs=bs.add(bo.find("div.datagrid-view tr.datagrid-header-row td[field="+bq+"]"))}return bs};var E=function(bq,bp){var bn=aX(bq),bo=bn.datagrid("getRows");return aX.array.map(bo,function(br){return br[bp]})};var bj=function(bq,bo){if(!aX.isNumeric(bo)||bo<0){return aX()}var bp=aX(bq),bn=bp.datagrid("getPanel");return bn.find("div.datagrid-view div.datagrid-body table tr.datagrid-row[datagrid-row-index="+bo+"]")};var aq=function(bq,bn){if(!aX.isNumeric(bn)||bn<0){return B}var bo=aX(bq),bp=bo.datagrid("getRows");return bp[bn]};var ak=function(bp,bq){if(!bq||!bq.field||!aX.isNumeric(bq.index)||bq.index<0){return aX()}var bn=aX(bp),bo=bn.datagrid("getRowDom",bq.index);return bo.find("td[field="+bq.field+"] .datagrid-cell")};var au=function(bo,bq){if(!bq||!bq.field||!aX.isNumeric(bq.index)||bq.index<0){return}var bn=aX(bo),bp=bn.datagrid("getRowData",bq.index);return bp[bq.field]};var bf=function(bo,bq){var bn=aX(bo),bp=bn.datagrid("getCellDom",bq);return bp&&bp.length?bp.html():B};var k=function(bo,bq){var bn=aX(bo),bp=bn.datagrid("getCellDom",bq);return bp&&bp.length?bp.text():B};var ao=aX.fn.datagrid.methods.getColumnFields;var M=function(bp,bo){var bn=aX(bp);if(bo==null||bo==B||aX.util.isBoolean(bo)){return ao.call(bn,bn,bo)}if(aX.util.isString(bo)){return aX.array.merge([],ao.call(bn,bn,true),ao.call(bn,bn,false))}};var Q=function(bs,br){var bo=aX(bs),bn=bo.datagrid("getColumnFields","all");if(!aX.array.contains(bn,br)){return[]}var bq=bo.datagrid("getRows"),bp=aX.array.clone(bq);aX.array.distinct(bp,function(bu,bt){return bu[br]==bt[br]});return bp};var a2=function(br,bq){var bo=aX(br),bn=bo.datagrid("getColumnFields","all");if(!aX.array.contains(bn,bq)){return[]}var bp=bo.datagrid("getColumnData",bq);aX.array.distinct(bp,function(bt,bs){return bt==bs});return bp};var t=function(bq,bp){var bo=aX(bq),bn=M(bq,bp);return aX.array.map(bn,function(br){return bo.datagrid("getColumnOption",br)})};var b=function(bp,bo){var bn=t(bp,bo);return aX.array.filter(bn,function(bq){return bq.hidden?true:false})};var A=function(bp,bo){var bn=t(bp,bo);return aX.array.filter(bn,function(bq){return !bq.hidden?true:false})};var c=function(bp,bo){var bn=b(bp,bo);return aX.array.map(bn,function(bq){return bq.field})};var bg=function(bp,bo){var bn=A(bp,bo);return aX.array.map(bn,function(bq){return bq.field})};var aM=function(bv,bp,bo,bA,bs,bw,bt){var bx=bo||aX(bv),bz=bs||bx.datagrid("getRows"),by=aX.isFunction(bp)?a1(bv,bp,bx,bz):bp,bu=bx.datagrid("getRowIndex",by),bt=(bt==null||bt==B||bt==true)?true:false;if(bu>-1){var bn=bA||bx.datagrid("options"),bq=bx.datagrid("getRowData",bu),br=bw||(bn._extensionsDatagrid?bn._extensionsDatagrid:(bn._extensionsDatagrid={}));br.filterData=aX.isArray(br.filterData)?br.filterData:br.filterData=[];bx.datagrid("getRowDom",bu).show();aX.array.remove(br.filterData,bq);if(bt){a4(bx,bn,br,bz)}}};var Y=function(bv,bp,bo,bA,bs,bw,bt){var bx=bo||aX(bv),bz=bs||bx.datagrid("getRows"),by=aX.isFunction(bp)?a1(bv,bp,bx,bz):bp,bu=bx.datagrid("getRowIndex",by),bt=bt==null||bt==B||bt==true?true:false;if(bu>-1){var bn=bA||bx.datagrid("options"),bq=bx.datagrid("getRowData",bu),br=bw||(bn._extensionsDatagrid?bn._extensionsDatagrid:(bn._extensionsDatagrid={}));br.filterData=aX.isArray(br.filterData)?br.filterData:[];bx.datagrid("unselectRow",bu).datagrid("uncheckRow",bu).datagrid("getRowDom",bu).hide();aX.array.attach(br.filterData,bq);if(bt){a4(bx,bn,br,bz)}}};var aS=function(bs,bp){var bu=aX(bs),bn=bu.datagrid("options"),bv=bu.datagrid("getRows"),br,bq=bn._extensionsDatagrid?bn._extensionsDatagrid:(bn._extensionsDatagrid={});if(bp===true){bq.filterData=[];var bo=bu.datagrid("getPanel"),bt=bo.find("div.datagrid-header-filter-item-icon");bo.find(".datagrid-view .datagrid-body tr.datagrid-row").show();aF(bt,"tree-checkbox1");i(bu,bn)}else{if(aX.isFunction(bp)){br=aX.array.filter(bv,bp)}else{if(aX.array.likeArray(bp)&&!aX.util.isString(bp)){br=bp}else{br=[bp]}}}if(br){aX.each(br,function(bw,bx){aM(bs,bx,bu,bn,bv,bq,false)});a4(bu,bn,bq,bv)}};var g=function(bs,bp){var bu=aX(bs),bn=bu.datagrid("options"),bv=bu.datagrid("getRows"),br,bq=bn._extensionsDatagrid?bn._extensionsDatagrid:(bn._extensionsDatagrid={});if(bp===true){bu.datagrid("unselectAll").datagrid("uncheckAll");bq.filterData=aX.array.clone(bv);var bo=bu.datagrid("getPanel"),bt=bo.find("div.datagrid-header-filter-item-icon");bo.find(".datagrid-view .datagrid-body tr.datagrid-row").hide();aF(bt,"tree-checkbox0");i(bu,bn)}else{if(aX.isFunction(bp)){br=aX.array.filter(bv,bp)}else{if(aX.array.likeArray(bp)&&!aX.util.isString(bp)){br=bp}else{br=[bp]}}}if(br){aX.each(br,function(bw,bx){Y(bs,bx,bu,bn,bv,bq,false)});a4(bu,bn,bq,bv)}};var ag=function(bq){var bo=aX(bq),bp=bo.datagrid("options"),bn=bp._extensionsDatagrid?bp._extensionsDatagrid:(bp._extensionsDatagrid={});return bn.filterData};var aP=function(bs){var bo=aX(bs),bp=bo.datagrid("options"),bq=bo.datagrid("getRows"),bn=bp._extensionsDatagrid?bp._extensionsDatagrid:(bp._extensionsDatagrid={}),br=aX.isArray(bn.filterData)?bn.filterData:[];return aX.array.filter(bq,function(bt){return aX.array.contains(br,bt)?false:true})};var F=function(bu,bv){var bw=aX(bu),bn=bw.datagrid("options"),bs=bn._extensionsDatagrid?bn._extensionsDatagrid:(bn._extensionsDatagrid={}),bo=bw.datagrid("getPanel"),br="div.datagrid-view div.datagrid-header tr.datagrid-header-row div.datagrid-header-filter-container";if(!bv){var bp=bo.find(br),bq=bp.length,bt=0;bp.slideUp("slow",function(){if(++bt==bq){aO(bw,bn);bn.columnFilter=bv}})}else{bn.columnFilter=bv;at(bw,bn,bs);aX.util.exec(function(){bo.find(br).hide().slideDown("slow")})}};var v=function(bt,bu){var bo=aX(bt);if(aX.util.isBoolean(bu)){bo.datagrid(bu?"showRows":"hideRows",true);return}if(!bu||!bu.field){return}var bs=bu.field,bq=bu.value,bn=aX.array.likeArray(bq)&&!aX.util.isString(bq),br=bn?function(bv){return aX.array.contains(bq,bv[bs])}:function(bv){return bq==bv[bs]},bp=bo.datagrid("findRows",br);bo.datagrid(bu.selected?"showRows":"hideRows",bp)};var aG=function(br,bq){var bn=aX(br);var bp=aX.data(bn[0],"datagrid"),bo=bp.options;if(bp.highlightField){bn.datagrid("getColumnDom",{field:bp.highlightField,header:true}).removeClass("datagrid-row-over")}bn.datagrid("getColumnDom",{field:bq,header:true}).filter(function(){return !aX(this).parent().hasClass("datagrid-row-selected")}).addClass("datagrid-row-over");bp.highlightField=bq};var aD=function(br,bp){var bv=aX(br),bn=bv.datagrid("getPanel"),bw,bt,bu=bp,bo=false,bq=true,bs;if(aX.isPlainObject(bp)){bu=bp.value;bt=bp.field;bo=bp.regular;bq=bp.ignoreCase;bw=bn.find("div.datagrid-body tr.datagrid-row td["+(bt?"field="+bt:"field")+"] div.datagrid-cell")}else{bw=bn.find("div.datagrid-body tr.datagrid-row td[field] div.datagrid-cell")}bs=bo?new RegExp(bu,bq?"gm":"igm"):bu;bw.each(function(){var bx=aX(this);bx.find("span.datagrid-cell-hightlight").replaceWith(function(){return aX(this).text()});if(!bu){return}var by=bx.html();if(!by){return}bx.html(aX.string.replaceAll(by,bu,"<span class='datagrid-cell-hightlight'>"+bu+"</span>"))})};var aJ=function(bo,bn){bn=aX.string.toBoolean(bn);alert("导出"+(bn?"全部":"当前页")+"数据")};var U=aX.fn.datagrid.extensions.initColumnExtendProperties=function(bo,bn){if(bn._initializedExtendProperties){return}var bp=bo.datagrid("getColumns","all");aX.each(bp,function(bq,br){aX.union(br,aX.fn.datagrid.extensions.columnOptions)});bn._initializedExtendProperties=true};var ai=aX.fn.datagrid.extensions.initRowDndExtensions=function(bn,bo){bo=bo||bn.datagrid("options");if(bo.dndRow){bn.datagrid("enableRowDnd")}};function at(by,bn,bp){bp=bp||(bn._extensionsDatagrid?bn._extensionsDatagrid:(bn._extensionsDatagrid={}));U(by,bp);var bq=by.datagrid("getData"),bt=bp.oldData;if(bq!=bt){bp.filterData=[]}aO(by,bn);i(by,bn);if(!bn.columnFilter){return}bp.oldData=bq;var bs=by.datagrid("getPanel").find("div.datagrid-view div.datagrid-header"),bu=bs.find("table.datagrid-htable tr.datagrid-header-row"),bo=bu.find("td[field]").filter(function(){var bB=aX(this),bA=bB.attr("colspan");return(!bA||bA=="1")&&!bB.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false}),bx=bn.columnFilter=aX.extend({panelHeight:100,position:"top"},bn.columnFilter),br=aX.array.contains(["top","bottom"],bx.position)?bx.position:"top",bv=bx.panelHeight=aX.isNumeric(bx.panelHeight)&&bx.panelHeight>=60?bx.panelHeight:60,bw=bs.height(),bz=by.datagrid("getRows");bo.each(function(){var bG=aX(this).addClass("datagrid-header-filter").removeClass("datagrid-header-filter-top datagrid-header-filter-bottom"),bA=bG.find("div.datagrid-cell").addClass("datagrid-header-filter-cell"),bF=bG.attr("field"),bE=by.datagrid("getColumnOption",bF),bD=bE.width,bC=aX("<hr />").addClass("datagrid-header-filter-line")[br=="top"?"prependTo":"appendTo"](this),bB=aX("<div></div>").attr("field",bF).addClass("datagrid-header-filter-container").css({height:bx.panelHeight,width:bD})[br=="top"?"prependTo":"appendTo"](this);bG.addClass(br=="top"?"datagrid-header-filter-top":"datagrid-header-filter-bottom");if(bF){aw(by,bn,bp,bB,bE,bz,bo)}});if(bp.filterData&&bp.filterData.length){by.datagrid("hideRows",bp.filterData)}else{a4(by,bn,bp,bz,bo)}}function aO(bp,bq){if(!bq.columnFilter){return}var bo=bp.datagrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function(){var bs=aX(this),br=bs.attr("colspan");return(!br||br=="1")&&!bs.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false});bo.removeClass("datagrid-header-filter datagrid-header-filter-top datagrid-header-filter-bottom").find("div.datagrid-cell").removeClass("datagrid-header-filter-cell");bo.find("hr.datagrid-header-filter-line,div.datagrid-header-filter-container").remove();var bn=bp.datagrid("getColumnFields","all");bp.datagrid("fixColumnSize",bn[bn.length-1])}function aw(bx,bn,bs,bp,bv,by,bo){if(!bv.filterable){return}var bw=bv.field,bu=bx.datagrid("getDistinctColumnData",bw),bq=aX.array.contains(["checkbox","livebox","caps","lower","none"],bv.filter)?bv.filter:"checkbox",bt=bv.precision,br=bv.step;switch(bq){case"checkbox":G(bx,bs,bp,bw,by,bu);break;case"livebox":T(bx,bp,bw,by);break;case"caps":j(bx,bp,bw,br,bt,by,bu,"<=",bn.columnFilter.panelHeight,bo);break;case"lower":j(bx,bp,bw,br,bt,by,bu,">=",bn.columnFilter.panelHeight,bo);break;case"none":break}}function G(bq,bp,bo,bs,br,bn){aX.each(bn,function(bu,by){var bx=aX("<div></div>").addClass("datagrid-header-filter-item").attr("text",by).appendTo(bo),bt=aX("<div></div>").addClass("datagrid-header-filter-item-text").text(by).appendTo(bx),bw=aX("<div></div>").addClass("datagrid-header-filter-item-icon").appendTo(bx),bv=function(){var bA=aX.array.filter(br,function(bB){return bB[bs]==by}),bz=aX.array.filter(bp.filterData,function(bB){return bB[bs]==by});bq.datagrid(bz.length?"showRows":"hideRows",bA)};bx.click(bv)})}function T(bq,bn,bs,br){aX("<div></div>").addClass("datagrid-header-filter-livebox-text").text("模糊过滤：").appendTo(bn);var bo=aX("<input />").addClass("datagrid-header-filter-livebox").appendTo(bn);var bp=aX("<a />").linkbutton({plain:true,iconCls:"icon-search"}).appendTo(bn).click(function(){bq.datagrid("showRows",true);var bu=bo.val();if(aX.string.isNullOrEmpty(bu)){bo.focus();return}var bt=aX.array.filter(br,function(bv){return String(bv[bs]).indexOf(bu)==-1});bq.datagrid("hideRows",bt);bo.focus()});aX("<a />").linkbutton({plain:true,iconCls:"icon-undo"}).appendTo(bn).click(function(){var bt=bo.val();if(bt){bo.val("").focus();bp.click()}else{bo.focus()}});bo.keypress(function(bt){if(bt.which==13){bp.click()}})}function j(bA,bz,bp,bs,bF,bv,bH,bq,bn,bG){var bu=aX.array.map(bH,function(bI){bI=parseFloat(bI);return aX.isNumeric(bI)?bI:0}),bD=bu.length?aX.array.min(bu):0,bE=bu.length?aX.array.max(bu):0,by=bu.length?aX.array.max(bu,function(bJ,bI){return aX.util.compare(aX.number.precision(bJ),aX.number.precision(bI))}):0,bw=bu.length?aX.number.precision(by):0,bB=bn-45,br=aX("<div></div>").addClass("datagrid-header-filter-itemwrap").text(bq).appendTo(bz),bt=aX("<div></div>").addClass("datagrid-header-filter-sliderwrap").css({height:bB+10})[bq=="<="?"appendTo":"prependTo"](bz),bx=aX("<input />").addClass("datagrid-header-filter-numeric").appendTo(br),bC=aX("<input />").addClass("datagrid-header-filter-slider").appendTo(bt),bo=function(bJ,bI){a(bA,bp,bv,bJ,bq,bx,bC,bG)};bx.numberbox({value:bq=="<="?bE:bD,min:bD,max:bE,precision:bF,onChange:bo,height:18});bx.keypress(function(bI){if(bI.which==13){var bJ=bx.val();bx.numberbox("setValue",aX.isNumeric(bJ)?bJ:0)}});bC.slider({height:bB,mode:"v",showTip:true,value:bq=="<="?bE:bD,min:bD,max:bE,rule:[bD,"|",bE],step:bs,onComplete:bo,tipFormatter:function(bI){return aX.number.round(bI||0,bw)}})}function a(bw,bt,bx,bv,bs,bu,bo,br){var bn=br||bw.datagrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function(){var bz=aX(this),by=bz.attr("colspan");return(!by||by=="1")&&!bz.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false});var bq=bn.filter(function(){return aX(this).attr("field")==bt});bu=bu?bu:bq.find(".datagrid-header-filter-numeric");bo=bo?bo:bq.find(".datagrid-header-filter-slider");var bp=aX.array.filter(bx,function(by){by=parseFloat(by[bt]);by=aX.isNumeric(by)?by:0;return bs==">="?(by<bv):(by>bv)});bw.datagrid("showRows",true).datagrid("hideRows",bp);bu.numberbox("setValue",bv);bo.slider("setValue",bv)}function a4(bp,bq,bo,br,bn){i(bp,bq);if(!bq.columnFilter){return}bn=bn||bp.datagrid("getPanel").find("div.datagrid-view div.datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function(){var bt=aX(this),bs=bt.attr("colspan");return(!bs||bs=="1")&&!bt.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false});bn.each(function(){var bt=aX(this),bs=bt.attr("field");Z(bp,bo,br,bt,bs)})}function i(bq,bs){if(!bs.pagination){return}var bo=bq.datagrid("getPager");if(bo&&bo.length){var bn=bq.datagrid("getVisibleRows").length,br=bq.datagrid("getRows").length,bp=bn<br?true:false,bt=bo.find("div.pagination-visiblerows");if(bs.showFilterText==false||((bs.showFilterText==null||bs.showFilterText==B)&&!bp)){return bt.remove()}if(bt.length){bt.html("当前页显示"+bn+"/"+br+"行")}else{bo.find("div.pagination-info").before('<div class="pagination-visiblerows">当前页显示'+bn+"/"+br+"行</div>")}}}function Z(bp,bo,br,bu,bt){var bs=bs=bp.datagrid("getColumnOption",bt),bn=bs.precision,bq=aX.array.contains(["checkbox","livebox","caps","lower","none"],bs.filter)?bs.filter:"checkbox";switch(bq){case"checkbox":ar(bp,bo,br,bu,bt);break;case"livebox":aL(bp,bo,br,bu,bt);break;case"caps":av(bp,bo,br,bu,bt);break;case"lower":an(bp,bo,br,bu,bt);break;case"none":break}}function ar(bo,bn,bp,br,bq){br.find("div.datagrid-header-filter-item").each(function(){var bw=aX(this),bx=bw.attr("text"),bu=bw.find("div.datagrid-header-filter-item-icon");var bv=aX.array.sum(bp,function(by){return by[bq]==bx?1:0}),bs=aX.array.sum(bn.filterData,function(by){return by[bq]==bx?1:0}),bt=bs==0?"tree-checkbox1":(bs>=bv?"tree-checkbox0":"tree-checkbox2");aX.easyui.tooltip.init(bw,{content:(aX.string.isNullOrEmpty(bx)?"空白":bx)+": 共"+bv+"个元素"});aF(bu,bt)})}function aF(bo,bn){bo.removeClass("tree-checkbox0 tree-checkbox1 tree-checkbox2").addClass(bn)}function aL(bo,bn,bp,br,bq){}function av(bo,bn,bp,br,bq){}function an(bo,bn,bp,br,bq){}function ay(bo,bp,bn){bn.onHeaderContextMenuBak=bp.onHeaderContextMenu;bp.onHeaderContextMenu=function(bt,bs){if(aX.isFunction(bn.onHeaderContextMenuBak)){bn.onHeaderContextMenuBak.apply(this,arguments)}if(!bp.enableHeaderContextMenu){return}var br=aX.fn.datagrid.extensions.parseContextMenuEventData(bo,bp,bt),bq=a3(bo,bp,bn,bt,bs,br);aX.easyui.showMenu({items:bq,left:bt.pageX,top:bt.pageY,hideDisabledMenu:bp.hideDisabledMenu});bt.preventDefault()}}function am(bo,bp,bn){bn.onRowContextMenuBak=bp.onRowContextMenu;bp.onRowContextMenu=function(bt,bu,bs){if(aX.isFunction(bn.onRowContextMenuBak)){bn.onRowContextMenuBak.apply(this,arguments)}if(bp.selectOnRowContextMenu){bo.datagrid("selectRow",bu)}if(!bp.enableRowContextMenu){return}var br=aX.fn.datagrid.extensions.parseContextMenuEventData(bo,bp,bt),bq=a5(bo,bp,bn,bt,bu,bs,br);if(bp.autoBindDblClickRow&&bp.dblClickRowMenuIndex>=0&&aX.util.likeArray(bp.rowContextMenu)&&!aX.util.isString(bp.rowContextMenu)&&bp.rowContextMenu.length>bp.dblClickRowMenuIndex){bq[bp.dblClickRowMenuIndex].bold=true}aX.easyui.showMenu({items:bq,left:bt.pageX,top:bt.pageY,hideDisabledMenu:bp.hideDisabledMenu});bt.preventDefault()}}function a0(bo,bp,bn){if(!bp.enableHeaderClickMenu){return}bo.datagrid("getPanel").find(".datagrid-view .datagrid-header table.datagrid-htable tr.datagrid-header-row td[field]").filter(function(){var br=aX(this),bq=br.attr("colspan");return(!bq||bq=="1")&&!br.find("div.datagrid-header-check,div.datagrid-header-rownumber").length?true:false}).find("div.datagrid-cell").each(function(){o(bo,bp,bn,this)})}function o(bp,bq,bo,bn){var br=aX("<span class='s-btn-downarrow datagrid-header-cell-arrow'>&nbsp;</span>").click(function(bw){var bz=aX(this),bv=bz.offset(),bB=bz.outerHeight(),by=bz.parent().parent().attr("field"),bA=aX.fn.datagrid.extensions.parseContextMenuEventData(bp,bq,bw),bx=a3(bp,bq,bo,bw,by,bA);var bu=aX.easyui.showMenu({items:bx,left:bv.left,top:bv.top+bB}),bt=bu.menu("options"),bs=bt.onHide;br.hidable=false;bt.onHide=function(){br.hidable=true;br.removeClass("datagrid-header-cell-arrow-show");bs.apply(this,arguments)};return false}).prependTo(bn);aX(bn).off(".hoverArrow").on({"mouseenter.hoverArrow":function(){br.addClass("datagrid-header-cell-arrow-show")},"mouseleave.hoverArrow":function(){if(!aX.util.isBoolean(br.hidable)||br.hidable){br.removeClass("datagrid-header-cell-arrow-show")}}})}function r(bo,bp,bn){bn.onDblClickRowBak=bp.onDblClickRow;bp.onDblClickRow=function(bu,bt){if(aX.isFunction(bn.onDblClickRowBak)){bn.onDblClickRowBak.apply(this,arguments)}var bs=aX.fn.datagrid.extensions.parseContextMenuEventData(bo,bp,null);items=a5(bo,bp,bn,null,bu,bt,bs);if(bp.autoBindDblClickRow&&bp.dblClickRowMenuIndex>=0&&aX.util.likeArray(bp.rowContextMenu)&&!aX.util.isString(bp.rowContextMenu)&&bp.rowContextMenu.length>bp.dblClickRowMenuIndex){var br=items[bp.dblClickRowMenuIndex],bq=br.handler||br.onclick;if(!br.disabled){return bq(null,bu,bt,bs,bo,br,null)}}}}function ax(bo,bp,bn){bn[bp.autoEditingEvent]=bp[bp.autoEditingEvent];bp[bp.autoEditingEvent]=function(br,bq){if(aX.isFunction(bn[bp.autoEditingEvent])){bn[bp.autoEditingEvent].apply(this,arguments)}if(bp.autoEditing){bo.datagrid("beginEdit",br)}}}function bc(bo,bp,bn){aX(bp.finishEditLocale).click(function(bs){if(bp.finishEditOnBlur&&aX.data(bo[0],"datagrid")){var bq=bo.datagrid("getPanel"),br=bo.datagrid("getEditingRowIndexs");if(!aX.contains(bq[0],bs.target)){aX.each(br,function(bu,bt){bo.datagrid(bp.finishEditMethod,bt)})}}})}function a3(bv,bn,bo,bq,bs,bu){var br=[],bp=aX.util.likeArray(bn.headerContextMenu)&&!aX.util.isString(bn.headerContextMenu)?bn.headerContextMenu:[];if(bp.length){aX.array.merge(br,bp)}var bt=aa(bv,bn,bo,bq,bs,bu);if(bt.length){aX.array.merge(br,"-",bt)}br=aX.fn.datagrid.extensions.parseHeaderContextMenuMap(bq,bs,bu,br,bv);if(br[0]=="-"){aX.array.removeAt(br,0)}return br}function a5(bw,bn,bq,br,bt,bo,bv){var bs=[],bp=aX.util.likeArray(bn.rowContextMenu)&&!aX.util.isString(bn.rowContextMenu)?bn.rowContextMenu:[];if(bp.length){aX.array.merge(bs,bp)}var bu=bm(bw,bn,bq,br,bt,bo,bv);if(bu.length){aX.array.merge(bs,"-",bu)}bs=aX.fn.datagrid.extensions.parseRowContextMenuMap(br,bt,bo,bv,bs,bw);if(bs[0]=="-"){aX.array.removeAt(bs,0)}return bs}function aa(bD,bn,bq,bt,bx,bA){var bo=[],bp=bn.exportMenu,bw=bD.datagrid("getColumnOption",bx),bs=bw.sortable;if(typeof bp=="object"){bp=aX.extend({current:false,all:false,submenu:true},bp)}var bC={text:"升序",iconCls:"icon-standard-hmenu-asc",disabled:bs!=true,handler:function(){return bD.datagrid("sort",{sortName:bx,sortOrder:"asc"})}};var bB={text:"降序",iconCls:"icon-standard-hmenu-desc",disabled:bs!=true,handler:function(){return bD.datagrid("sort",{sortName:bx,sortOrder:"desc"})}};var bz={text:"显示/隐藏列",iconCls:"icon-standard-application-view-columns",disabled:false,children:[{text:"显示全部列",iconCls:function(){var bE=bq.fields?bq.fields.length:0;var bF=aX.array.sum(bq.fieldOptions,function(bG){return bG.hidden?0:1});return bF>=bE?"tree-checkbox1":(bF==0?"tree-checkbox0":"tree-checkbox2")},hideOnClick:false,handler:function(bI,bH,bG,bE,bF,bJ){aX.each(bq.fields,function(){bE.datagrid("showColumn",this)});aX(this).parent().children("div.menu-item:not(:eq(1))").each(function(){bJ.menu("setIcon",{target:this,iconCls:"tree-checkbox1"});bJ.menu("enableItem",this)})}},{text:"还原默认",iconCls:"icon-standard-application-view-tile",hideOnClick:false,handler:function(bI,bH,bG,bE,bF,bK){aX.each(bq.fieldOptionsBackup,function(){bE.datagrid(this.hidden==true?"hideColumn":"showColumn",this.field)});var bJ=aX(this).parent();bJ.children("div.menu-item:gt(1)").each(function(){var bM=aX(this).text(),bL=aX.array.first(bq.fieldOptions,function(bN){return bN.title==bM});if(bL){bK.menu("setIcon",{target:this,iconCls:bL.hidden?"tree-checkbox0":"tree-checkbox1"})}bK.menu("enableItem",this)});bJ.children("div.menu-item:first").each(function(){var bL=bq.fields?bq.fields.length:0;var bM=aX.array.sum(bq.fieldOptions,function(bN){return bN.hidden?0:1});bK.menu("setIcon",{target:this,iconCls:bM>=bL?"tree-checkbox1":(bM==0?"tree-checkbox0":"tree-checkbox2")})})}},"-"]};var by={text:"过滤/显示",iconCls:"icon-standard-application-view-list",disabled:!bw.filterable,children:[]};var bv={text:"导出当前页",iconCls:"icon-standard-page-white-put",disabled:!(bp==true||bp.current==true),handler:function(){return bD.datagrid("exportExcel",false)}};var bu={text:"导出全部",iconCls:"icon-standard-page-white-stack",disabled:!(bp==true||bp.all==true),handler:function(){return bD.datagrid("exportExcel",true)}};aX.util.merge(bz.children,d(bD,bn,bq,bt,bx,bA));if(bw.filterable){aX.util.merge(by.children,e(bD,bn,bq,bt,bx,bA))}aX.util.merge(bo,[bC,bB,"-",bz,by]);var br=[bv,bu];if(bp){aX.array.merge(bo,"-",typeof bp=="object"&&!bp.submenu?br:{text:"导出数据",iconCls:"icon-standard-page-save",children:br})}return bo}function d(bo,bq,bn,bs,br,bp){return aX.array.map(bn.fieldOptions,function(bu){var bt=function(bA,bB,bC,bE,bD,bv){var bw=aX(this),bz=bw.parent().find(".menu-item:gt(1) .tree-checkbox1").length;if((bz==1&&!bu.hidden)||!bu.hidable){return}bE.datagrid(bu.hidden?"showColumn":"hideColumn",bu.field);bv.menu("setIcon",{target:this,iconCls:bu.hidden?"tree-checkbox0":"tree-checkbox1"});bz=aX.array.sum(bn.fieldOptions,function(bF){return bF.hidden?0:1});var by=bn.fields?bn.fields.length:0;bv.menu("setIcon",{target:bw.parent().children("div.menu-item:first"),iconCls:bz>=by?"tree-checkbox1":(bz==0?"tree-checkbox0":"tree-checkbox2")});var bx=bw.parent().find(".menu-item:gt(1)").filter(function(){return aX(".tree-checkbox1",this).length?true:false});bx.each(function(){bv.menu(bx.length>1?"enableItem":"disableItem",this)})};return{text:bu.title||bu.field,iconCls:bu.hidden?"tree-checkbox0":"tree-checkbox1",hideOnClick:false,disabled:!bu.hidable?true:false,handler:bt}})}function e(bA,bn,bq,bs,bw,by){var bB=bA.datagrid("getRows"),bx=bA.datagrid("getDistinctColumnData",bw),bp=[{text:"全部",hideOnClick:false,iconCls:(!bq.filterData||!bq.filterData.length)?"tree-checkbox1":(bq.filterData.length>=bB.length?"tree-checkbox0":"tree-checkbox2"),handler:function(bG,bF,bE,bC,bD,bH){if(bq.filterData&&bq.filterData.length){bC.datagrid("showRows",true)}else{bC.datagrid("hideRows",true)}aX(this).parent().children("div.menu-item[hideOnClick=false]").each(function(){bH.menu("setIcon",{target:this,iconCls:bq.filterData&&bq.filterData.length?"tree-checkbox0":"tree-checkbox1"})})}},"-"];var bo=bx.length>=15,br=bo?aX.array.left(bx,10):bx,bt=aX.array.map(br,function(bG){var bF=aX.array.filter(bB,function(bI){return bI[bw]==bG}),bH=bF.length,bC=aX.array.sum(bq.filterData,function(bI){return bI[bw]==bG?1:0}),bD=!bC?"tree-checkbox1":(bC>=bH?"tree-checkbox0":"tree-checkbox2");var bE=function(bN,bM,bL,bJ,bK,bO){var bI=aX.array.sum(bq.filterData,function(bP){return bP[bM]==bG?1:0});bJ.datagrid(bI?"showRows":"hideRows",bF);bO.menu("setIcon",{target:this,iconCls:bI?"tree-checkbox1":"tree-checkbox0"});aX(this).parent().children("div.menu-item:first").each(function(){bO.menu("setIcon",{target:this,iconCls:(!bq.filterData||!bq.filterData.length)?"tree-checkbox1":(bq.filterData.length>=bB.length?"tree-checkbox0":"tree-checkbox2")})})};return{text:bG,iconCls:bD,hideOnClick:false,handler:bE}});aX.array.merge(bp,bt);if(bo){var bu=bA.datagrid("getColumnOption",bw),bv=bu.title?bu.title:bu.field,bz=function(){var bD=aX('<input type="button" value="全部选择" />').click(function(){bA.datagrid("showRows",true);aX(this).parent().find(":checkbox").each(function(){this.checked=true})});var bC=aX('<input type="button" value="全部不选" />').click(function(){bA.datagrid("hideRows",true);aX(this).parent().find(":checkbox").each(function(){this.checked=false})});aX("<div></div>").append("<div>列："+bv+"，共"+bx.length+"项</div><hr />").css({padding:"10px"}).append(bD).append(bC).append("<hr />").each(function(){var bF=aX(this),bE=aX("<ul></ul>").css({"list-style-type":"decimal","padding-left":"40px","line-height":"18px"}).appendTo(bF);aX.each(bx,function(bH,bM){var bN="itemCheckbox_"+aX.util.guid("N"),bK=!aX.array.some(bq.filterData,function(bO){return bO[bw]==bM}),bL=aX("<li></li>").appendTo(bE),bJ=aX("<input />").attr({type:"checkbox",id:bN,checked:bK}).appendTo(bL),bG=aX("<label></label>").attr("for",bN).text(bM).appendTo(bL),bI=function(){var bP=aX.array.filter(bB,function(bQ){return bQ[bw]==bM}),bO=aX.array.sum(bq.filterData,function(bQ){return bQ[bw]==bM?1:0});bA.datagrid(bO?"showRows":"hideRows",bP)};bJ.click(bI)})}).dialog({title:"过滤/显示",iconCls:"icon-standard-application-view-detail",height:260,width:220,left:bs.pageX,top:bs.pageY,collapsible:false,minimizable:false,maximizable:false,closable:true,modal:true,resizable:true,onClose:function(){aX(this).dialog("destroy")}}).dialog("open")};aX.array.merge(bp,["-",{text:"处理更多(共"+bx.length+"项)...",iconCls:"icon-standard-application-view-detail",handler:bz}])}return bp}function bm(bw,bx,bv,bB,bu,bt,bq){var bA=[],br=bx.pagingMenu,bz=bx.moveMenu,bs=bx.exportMenu;if(typeof br=="object"){br=aX.extend({disabled:false,submenu:true},br)}if(typeof bz=="object"){bz=aX.extend({up:false,down:false,submenu:true},bz)}if(typeof bs=="object"){bs=aX.extend({current:false,all:false,submenu:true},bs)}var bp={text:"刷新当前页",iconCls:"pagination-load",disabled:!bx.refreshMenu,handler:function(){bw.datagrid("reload")}};var bo={text:"首页",iconCls:"pagination-first",disabled:function(){return !bx.pagination||bq.page<=1},handler:function(){if(bq.page>1){bq.pager.pagination("select",1)}}};var bn={text:"上一页",iconCls:"pagination-prev",disabled:function(){return !bx.pagination||bq.page<=1},handler:function(){if(bq.page>1){bq.pager.pagination("select",bq.page-1)}}};var bL={text:"下一页",iconCls:"pagination-next",disabled:function(){return !bx.pagination||bq.page>=bq.pageCount},handler:function(){if(bq.page<bq.pageCount){bq.pager.pagination("select",bq.page+1)}}};var bK={text:"末页",iconCls:"pagination-last",disabled:function(){return !bx.pagination||bq.page>=bq.pageCount},handler:function(){if(bq.page<bq.pageCount){bq.pager.pagination("select",bq.pageCount)}}};var bI={text:"移至最上",iconCls:"icon-standard-arrow-up",disabled:!(bz==true||bz.top==true),handler:function(){bw.datagrid("moveRow",{source:bu,target:0,point:"top"})}};var bG={text:"上移",iconCls:"icon-standard-up",disabled:!(bz==true||bz.up==true),handler:function(){bw.datagrid("shiftRow",{point:"up",index:bu})}};var bE={text:"下移",iconCls:"icon-standard-down",disabled:!(bz==true||bz.down==true),handler:function(){bw.datagrid("shiftRow",{point:"down",index:bu})}};var bC={text:"移至最下",iconCls:"icon-standard-arrow-down",disabled:!(bz==true||bz.bottom==true),handler:function(){var bM=bw.datagrid("getRows");bw.datagrid("moveRow",{source:bu,target:bM.length-1,point:"bottom"})}};var bH={text:"导出当前页",iconCls:"icon-standard-page-white-put",disabled:!(bs==true||bs.current==true),handler:function(){return bw.datagrid("exportExcel",false)}};var bF={text:"导出全部",iconCls:"icon-standard-page-white-stack",disabled:!(bs==true||bs.all==true),handler:function(){return bw.datagrid("exportExcel",true)}};bA.push(bp);var bJ=[bo,bn,bL,bK],bD=[bI,bG,"-",bE,bC],by=[bH,bF];if(br){aX.array.merge(bA,"-",typeof br=="object"&&!br.submenu?bJ:{text:"翻页",iconCls:"",disabled:!(br==true||!br.disabled),children:bJ})}if(bz){aX.array.merge(bA,"-",typeof bz=="object"&&!bz.submenu?bD:{text:"上/下移动",iconCls:"",disabled:!bz,children:bD})}if(bs){aX.array.merge(bA,"-",typeof bs=="object"&&!bs.submenu?by:{text:"导出数据",iconCls:"icon-standard-page-save",disabled:!bs,children:by})}return bA}aX.fn.datagrid.extensions.parseHeaderContextMenuMap=function(br,bq,bp,bo,bn){return aX.array.map(bo,function(bu,bt){if(!bu||aX.util.isString(bu)){return bu}var bs=aX.extend({},bu);bs.id=aX.isFunction(bu.id)?bu.id.call(bs,br,bq,bp,bn):bu.id;bs.text=aX.isFunction(bu.text)?bu.text.call(bs,br,bq,bp,bn):bu.text;bs.iconCls=aX.isFunction(bu.iconCls)?bu.iconCls.call(bs,br,bq,bp,bn):bu.iconCls;bs.disabled=aX.isFunction(bu.disabled)?bu.disabled.call(bs,br,bq,bp,bn):bu.disabled;bs.hideOnClick=aX.isFunction(bu.hideOnClick)?bu.hideOnClick.call(bs,br,bq,bp,bn):bu.hideOnClick;bs.onclick=aX.isFunction(bu.onclick)?function(bw,bv,bx){bu.onclick.call(this,bw,bq,bp,bn,bv,bx)}:bu.onclick;bs.handler=aX.isFunction(bu.handler)?function(bw,bv,bx){bu.handler.call(this,bw,bq,bp,bn,bv,bx)}:bu.handler;if(bs.children&&bs.children.length){bs.children=aX.fn.datagrid.extensions.parseHeaderContextMenuMap(br,bq,bp,bs.children,bn)}return bs})};aX.fn.datagrid.extensions.parseRowContextMenuMap=function(br,bs,bq,bp,bo,bn){return aX.array.map(bo,function(bv,bu){if(!bv||aX.util.isString(bv)){return bv}var bt=aX.extend({},bv);bt.id=aX.isFunction(bv.id)?bv.id.call(bt,br,bs,bq,bp,bn):bv.id;bt.text=aX.isFunction(bv.text)?bv.text.call(bt,br,bs,bq,bp,bn):bv.text;bt.iconCls=aX.isFunction(bv.iconCls)?bv.iconCls.call(bt,br,bs,bq,bp,bn):bv.iconCls;bt.disabled=aX.isFunction(bv.disabled)?bv.disabled.call(bt,br,bs,bq,bp,bn):bv.disabled;bt.hideOnClick=aX.isFunction(bv.hideOnClick)?bv.hideOnClick.call(bt,br,bs,bq,bp,bn):bv.hideOnClick;bt.onclick=aX.isFunction(bv.onclick)?function(bx,bw,by){bv.onclick.call(this,bx,bs,bq,bp,bn,bw,by)}:bv.onclick;bt.handler=aX.isFunction(bv.handler)?function(bx,bw,by){bv.handler.call(this,bx,bs,bq,bp,bn,bw,by)}:bv.handler;if(bt.children&&bt.children.length){bt.children=aX.fn.datagrid.extensions.parseRowContextMenuMap(br,bs,bq,bp,bt.children,bn)}return bt})};aX.fn.datagrid.extensions.parseContextMenuEventData=function(bn,bp,br){var bo=aX.fn.datagrid.extensions.parseRemoteQueryParams(bp);var bq=aX.fn.datagrid.extensions.parsePaginationParams(bn,bp);return aX.extend({},bo,bq,{e:br,grid:bn})};aX.fn.datagrid.extensions.parsePaginationParams=function(bq,bs){var bp={};if(bs.pagination){var bn=bq.datagrid("getPager");var bt=bn.pagination("options");var br=bt.total;var bo=Math.ceil(parseFloat(br)/parseFloat(bt.pageSize));aX.extend(bp,{pager:bn,total:br,pageCount:bo})}return bp};aX.fn.datagrid.extensions.parseRemoteQueryParams=function(bo){var bn=aX.extend({},bo.queryParams);if(bo.pagination){aX.extend(bn,{page:bo.pageNumber,rows:bo.pageSize})}if(bo.sortName){aX.extend(bn,{sort:bo.sortName,order:bo.sortOrder})}bn=aX.fn.datagrid.extensions.parsePagingQueryParams(bo,bn);return bn};var ap=function(bn,bo){var bp=bn.datagrid("getRows");bn.datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").each(function(){var br=aX(this),bq=parseInt(br.attr("datagrid-row-index")),bs=bp[bq];aE(bn,bo,bq,bs,br)})};var aE=function(bp,bq,bn,bs,br){br=br||bp.datagrid("getRowDom",bn);if(bq.rowTooltip){var bt=function(bv){var bu=aX(this),bw=aX.isFunction(bq.rowTooltip)?bq.rowTooltip.call(br,bn,bs):bo(bs);bu.tooltip("update",bw)};br.each(function(){aX.easyui.tooltip.init(this,{onShow:bt})})}else{br.children("td[field]").each(function(){var by=aX(this),bw=by.attr("field"),bv=bp.datagrid("getColumnOption",bw);if(!bv||!bv.tooltip){return}var bu=by.find("div.datagrid-cell"),bx=function(bA){var bz=aX(this),bB=aX.isFunction(bv.tooltip)?bv.tooltip.call(bu,bs[bw],bn,bs):bs[bw];bz.tooltip("update",bB)};aX.easyui.tooltip.init(bu,{onShow:bx})})}function bo(bw){var bv=bp.datagrid("getColumns","all"),bu=aX("<table></table>").css({padding:"5px"});aX.each(bv,function(bx,by){if(!by||!by.field||!by.title){return}var bz=bp.datagrid("getCellDisplay",{field:by.field,index:bn});bu.append("<tr><td style='text-align: right; width: 150px;'>"+by.title+":</td><td style='width: 250px;'>"+bz+"</td></tr>")});return bu}};var aN=function(bB,bn,bs){if(!bn.extEditing){return}var bt=bB.datagrid("getRowDom",bs);if(!bt.length){return}var bw=bB.datagrid("getPanel").find("div.datagrid-view"),by=bw.find("div.datagrid-view1"),bx=bw.find("div.datagrid-view2"),br=bx.find("div.datagrid-body").css("position","relative"),bp=by.outerWidth(),bA=bt.outerHeight(),bv=bt.position(),bu=bv.top+bA+br.scrollTop()-bx.find("div.datagrid-header").outerHeight();var bo=aX('<div class="dialog-button datagrid-rowediting-panel"></div>').appendTo(br).css("top",bu).attr("datagrid-row-index",bs);aX("<a></a>").appendTo(bo).linkbutton({plain:false,iconCls:"icon-ok",text:"保存"}).click(function(){bB.datagrid("endEdit",bs);q(bB,bn,bs)});aX("<a></a>").appendTo(bo).linkbutton({plain:false,iconCls:"icon-cancel",text:"取消"}).click(function(){bB.datagrid("cancelEdit",bs);q(bB,bn,bs)});var bz=(bn.width-bo.outerWidth())/2-bp,bq=bz>0?bz:0;bo.css("left",bq)};var aj=function(bp,bn,bo){bn=bn||bp.datagrid("getPanel").find("div.datagrid-view div.datagrid-view2 div.datagrid-body");bn.find("div.datagrid-rowediting-panel[datagrid-row-index="+bo+"]").remove()};var q=function(bo,bp,bn){if(!bp.extEditing){return}body=bo.datagrid("getPanel").find("div.datagrid-view div.datagrid-view2 div.datagrid-body");aj(bo,body,bn)};var S=function(bp,bq,bn){var bo=bq._extensionsDatagrid?bq._extensionsDatagrid:(bq._extensionsDatagrid={});if(bq.singleEditing){bp.datagrid("endEdit",bo.lastEditingIndex)}bo.lastEditingIndex=bn};var bi=aX.fn.datagrid.extensions.initExtensions=function(bw,bo){var bp=bo._extensionsDatagrid?bo._extensionsDatagrid:(bo._extensionsDatagrid={});if(bp._initialized){return}var br=bw.datagrid("getColumnFields",false);bp.fields=aX.array.filter(br,function(by){return bw.datagrid("getColumnOption",by).title?true:false});bp.fieldOptions=aX.array.map(bp.fields,function(by){return bw.datagrid("getColumnOption",by)});bp.fieldOptionsBackup=aX.array.map(bp.fieldOptions,function(by){return aX.extend({},by)});bp.filterData=[];bt();bq();bv();bs();bn();bu();function bt(){U(bw,bp)}function bq(){bw.datagrid("setOffset",bo.offset)}function bv(){ay(bw,bo,bp);am(bw,bo,bp);a0(bw,bo,bp)}function bs(){r(bw,bo,bp)}function bn(){ax(bw,bo,bp)}function bu(){bc(bw,bo,bp)}var bx=bw.datagrid("getRows");if(!bx||!bx.length){at(bw,bo,bp)}bp._initialized=true};aX.fn.datagrid.extensions.parseOrderbyParams=function(bo,bn){bo=aX.string.isNullOrWhiteSpace(bo)?"":aX.trim(bo);bn=aX.string.isNullOrWhiteSpace(bn)?"":aX.trim(bn);bn=bn.toLowerCase();if(bn!="asc"&&bn!="desc"){bn="asc"}return aX.trim(bo+" "+bn)};aX.fn.datagrid.extensions.parsePagingQueryParams=function(bo,bp){var bn=aX.util.parseMapFunction(bp);if(bo.pagination){bn.pageNumber=bn.page;bn.pageSize=bn.rows;bn.pageIndex=bn.pageNumber-1}bn.orderby=aX.fn.datagrid.extensions.parseOrderbyParams(bn.sort,bn.order);return bn};var P=aX.fn.datagrid.extensions.loader=function(br,bq,bn){var bo=aX(this),bp=bo.datagrid("options");bi(bo,bp);if(!bp.url){return false}br=aX.fn.datagrid.extensions.parsePagingQueryParams(bp,br);aX.ajax({type:bp.method,url:bp.url,data:br,dataType:"json",success:function(bs){bq(bs)},error:function(){bn.apply(this,arguments)}})};var a8=function(bn){return bn?(aX.isArray(bn)?{total:bn.length,rows:bn}:bn):{total:0,rows:[]}};var x=aX.fn.datagrid.defaults.onLoadSuccess;var bb=aX.fn.datagrid.extensions.onLoadSuccess=function(bq){if(aX.isFunction(x)){x.apply(this,arguments)}var bo=aX(this),bp=bo.datagrid("options"),bn=bp._extensionsDatagrid?bp._extensionsDatagrid:(bp._extensionsDatagrid={});at(bo,bp,bn);ai(bo,bp);ap(bo,bp)};var I=aX.fn.datagrid.defaults.onResizeColumn;var aC=aX.fn.datagrid.extensions.onResizeColumn=function(bt,bq){if(aX.isFunction(I)){I.apply(this,arguments)}var bp=aX(this),br=bp.datagrid("options");if(br.columnFilter){var bo=bp.datagrid("getPanel"),bs=bp.datagrid("getColumnOption",bt),bn=bo.find("div.datagrid-header-filter-container[field="+bt+"]");bn.width(bs.width)}};var n=aX.fn.datagrid.defaults.onBeforeEdit;var aW=aX.fn.datagrid.extensions.onBeforeEdit=function(bn,bq){if(aX.isFunction(n)){n.apply(this,arguments)}var bo=aX(this),bp=bo.datagrid("options");aN(bo,bp,bn);S(bo,bp,bn);bo.datagrid("getPanel").find("div.datagrid-view div.datagrid-body table tr.datagrid-row").draggable("disable")};var O=aX.fn.datagrid.defaults.onAfterEdit;var aB=aX.fn.datagrid.extensions.onAfterEdit=function(bn,bs,bq){if(aX.isFunction(O)){O.apply(this,arguments)}var bp=aX(this),br=bp.datagrid("options"),bo=br._extensionsDatagrid?br._extensionsDatagrid:(br._extensionsDatagrid={});q(bp,br,bn);at(bp,br,bo);ai(bp,br);aE(bp,br,bn,bs)};var D=aX.fn.datagrid.defaults.onCancelEdit;var be=aX.fn.datagrid.extensions.onCancelEdit=function(bn,bq){if(aX.isFunction(D)){D.apply(this,arguments)}var bo=aX(this),bp=bo.datagrid("options");q(bo,bp,bn);ai(bo,bp);aE(bo,bp,bn,bq)};var aZ=aX.fn.datagrid.extensions.methods={updateRow:function(bo,bn){return bo.each(function(){a6(this,bn)})},appendRow:function(bo,bn){return bo.each(function(){z(this,bn)})},insertRow:function(bo,bn){return bo.each(function(){s(this,bn)})},beginEdit:function(bo,bn){return bo.each(function(){R(this,bn)})},isChecked:function(bo,bn){return V(bo[0],bn)},isSelected:function(bo,bn){return bd(bo[0],bn)},isEditing:function(bo,bn){return aQ(bo[0],bn)},getEditingRowIndex:function(bn){return y(bn[0])},getEditingRowIndexs:function(bn){return aH(bn[0])},freezeColumn:function(bo,bn){return bo.each(function(){ae(this,bn)})},unfreezeColumn:function(bo,bn){return bo.each(function(){L(this,bn)})},moveRow:function(bo,bn){return bo.each(function(){f(this,bn)})},shiftRow:function(bo,bn){return bo.each(function(){p(this,bn)})},nextRow:function(bo,bn){return bk(bo[0],bn)},prevRow:function(bo,bn){return K(bo[0],bn)},popRow:function(bo,bn){return J(bo[0],bn)},enableRowDnd:function(bn){return bn.each(function(){aA(this)})},disableRowDnd:function(bn){return bn.each(function(){bl(this)})},moveColumn:function(bo,bn){return bo.each(function(){m(this,bn)})},shiftColumn:function(bo,bn){return bo.each(function(){bh(this,bn)})},nextColumn:function(bo,bn){return aY(bo[0],bn)},prevColumn:function(bo,bn){return aV(bo[0],bn)},deleteColumn:function(bo,bn){return bo.each(function(){aU(this,bn)})},popColumn:function(bo,bn){return aI(bo[0],param)},getColumnDom:function(bo,bn){return aK(bo[0],bn)},getColumnData:function(bo,bn){return E(bo[0],bn)},getRowDom:function(bo,bn){return bj(bo[0],bn)},getRowData:function(bo,bn){return aq(bo[0],bn)},getCellDom:function(bo,bn){return ak(bo[0],bn)},getCellData:function(bo,bn){return au(bo[0],bn)},getCellDisplay:function(bo,bn){return bf(bo[0],bn)},getCellDisplayText:function(bo,bn){return k(bo[0],bn)},getColumnFields:function(bo,bn){return M(bo[0],bn)},getDistinctRows:function(bo,bn){return Q(bo[0],bn)},getDistinctColumnData:function(bo,bn){return a2(bo[0],bn)},getColumns:function(bo,bn){return t(bo[0],bn)},getHiddenColumns:function(bo,bn){return b(bo[0],bn)},getVisibleColumns:function(bo,bn){return A(bo[0],bn)},getHiddenColumnFields:function(bo,bn){return c(bo[0],bn)},getVisibleColumnFields:function(bo,bn){return bg(bo[0],bn)},showRow:function(bo,bn){return bo.each(function(){aM(this,bn)})},hideRow:function(bo,bn){return bo.each(function(){Y(this,bn)})},showRows:function(bo,bn){return bo.each(function(){aS(this,bn)})},hideRows:function(bo,bn){return bo.each(function(){g(this,bn)})},getHiddenRows:function(bn){return ag(bn[0])},getVisibleRows:function(bn){return aP(bn[0])},highlightColumn:function(bo,bn){return bo.each(function(){aG(this,bn)})},livesearch:function(bo,bn){return bo.each(function(){aD(this,bn)})},hasMuliRowHeader:function(bn){return ac(bn[0])},findRow:function(bo,bn){return a1(bo[0],bn)},findRows:function(bo,bn){return ba(bo[0],bn)},deleteRow:function(bo,bn){return bo.each(function(){l(this,bn)})},deleteRows:function(bo,bn){return bo.each(function(){ab(this,bn)})},setColumnTitle:function(bo,bn){return bo.each(function(){ad(this,bn)})},setColumnWidth:function(bo,bn){return bo.each(function(){h(this,bn)})},setOffset:function(bo,bn){return bo.each(function(){af(this,bn)})},setColumnFilter:function(bo,bn){return bo.each(function(){F(this,bn)})},columnFilterSelect:function(bo,bn){return bo.each(function(){v(this,bn)})},exportExcel:function(bo,bn){return bo.each(function(){aJ(this,bn)})}};var ah=aX.fn.datagrid.extensions.defaults={offset:null,loadFilter:a8,autoBindDblClickRow:true,dblClickRowMenuIndex:0,exportMenu:false,selectOnRowContextMenu:false,hideDisabledMenu:false,headerContextMenu:null,rowContextMenu:null,enableHeaderClickMenu:true,enableHeaderContextMenu:true,enableRowContextMenu:true,moveMenu:false,pagingMenu:{submenu:false},refreshMenu:true,dndRow:false,rowTooltip:false,extEditing:true,autoEditing:false,autoEditingEvent:"onDblClickRow",finishEditOnBlur:false,finishEditLocale:window.document,finishEditMethod:"endEdit",singleEditing:true,autoFocusField:true,autoWrapEdit:true,cancelEditOnEsc:true,columnFilter:null,showFilterText:B,loader:P,onLoadSuccess:bb,onResizeColumn:aC,onBeforeEdit:aW,onAfterEdit:aB,onCancelEdit:be,onBeforeDeleteColumn:function(bn){},onDeleteColumn:function(bn){},onBeforeMoveColumn:function(bo,bp,bn){},onMoveColumn:function(bo,bp,bn){},onBeforeDrop:function(bp,bo,bn){},onDrop:function(bp,bo,bn){},onBeforeDrag:function(bn,bo){},onStartDrag:function(bn,bo){},onStopDrag:function(bn,bo){},onDragEnter:function(bo,bn){},onDragOver:function(bo,bn){},onDragLeave:function(bo,bn){},onBeforeUpdateRow:function(bn,bo){},onUpdateRow:function(bn,bo){},onBeforeAppendRow:function(bn){},onAppendRow:function(bn){},onBeforeInsertRow:function(bn,bo){},onBeforeRow:function(bn,bo){},onBeforeDeleteRow:function(bn,bo){},onDeleteRow:function(bn,bo){}};var aT=aX.fn.datagrid.extensions.columnOptions={tooltip:false,filterable:true,hidable:true,filter:"checkbox",precision:1,step:1};aX.extend(aX.fn.datagrid.defaults,ah);aX.extend(aX.fn.datagrid.methods,aZ);var u=aX.fn.datagrid.defaults.editors,al=u.checkbox.init,C=u.datebox.init,aR=u.combobox.init,a9=u.combotree.init,a7=u.combogrid.init;aX.extend(u.checkbox,{init:function(bn,bo){return al.apply(this,arguments).addClass("datagrid-editable-input datagrid-editable-checkbox")},setFocus:function(bn){aX(bn).datebox("textbox").focus()}});aX.extend(u.datebox,{init:function(bn,bo){var bp=C.apply(this,arguments);bp.datebox("textbox").addClass("datagrid-editable-input");return bp},setFocus:function(bn){aX(bn).datebox("textbox").focus()}});aX.extend(u.combobox,{init:function(bn,bo){var bp=aR.apply(this,arguments);bp.combobox("textbox").addClass("datagrid-editable-input");return bp},setFocus:function(bn){aX(bn).combobox("textbox").focus()}});aX.extend(u.combotree,{init:function(bn,bo){var bp=a9.apply(this,arguments);bp.combotree("textbox").addClass("datagrid-editable-input");return bp},setFocus:function(bn){aX(bn).combotree("textbox").focus()}});aX.extend(u.combogrid,{init:function(bn,bo){var bp=a7.apply(this,arguments);bp.combogrid("textbox").addClass("datagrid-editable-input");return bp},setValue:function(bq,bp){var bn=aX(bq),bo=bn.combogrid("options");if(bp){if(bo.multiple){if(aX.util.likeArrayNotString(bp)){bn.combogrid("setValues",bp)}else{if(typeof bp=="string"){bn.combogrid("setValues",bp.split(bo.separator))}else{bn.combogrid("setValue",bp)}}}else{bn.combogrid("setValue",bp)}}else{bn.combogrid("clear")}},setFocus:function(bn){aX(bn).combogrid("textbox").focus()}});aX(document).on("keydown","div.datagrid div.datagrid-editable input.datagrid-editable-input",function(bo){switch(bo.which){case 13:bp();break;case 27:bn();break;default:break}function bp(){var br=aX(bo.target),bu=br.currentDatagrid(),bv=bu.datagrid("options"),bt=aX.data(bu[0],"treegrid")?true:false;if(!bv.autoWrapEdit||bt){return}var bw=bu.datagrid("getRows");if(!bw||!bw.length){return}var bq=bw.length,bx=br.closest("td[field]").attr("field"),bs=window.parseInt(br.closest("tr[datagrid-row-index]").attr("datagrid-row-index"));bu.datagrid("endEdit",bs);if(bs<bq-1){bu.datagrid("beginEdit",bs+1)}}function bn(){var bq=aX(bo.target),bt=bq.currentDatagrid(),bu=bt.datagrid("options"),bs=aX.data(bt[0],"treegrid")?true:false;if(!bu.cancelEditOnEsc||bs){return}var br=window.parseInt(bq.closest("tr[datagrid-row-index]").attr("datagrid-row-index"));bt.datagrid("cancelEdit",br)}})})(jQuery);